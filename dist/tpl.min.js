!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("_"),require("jquery"),require("observer")):"function"==typeof define&&define.amd?define(["_","jquery","observer"],e):"object"==typeof exports?exports.tpl=e(require("_"),require("jquery"),require("observer")):t.tpl=e(t._,t.jQuery,t.observer)}(this,function(t,e,i){return function(t){function e(r){if(i[r])return i[r].exports;var n=i[r]={exports:{},id:r,loaded:!1};return t[r].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=i(1),o=i(2),s=i(3),c=i(4),u=i(6),a=s.TextNodeDirective,p={delimiter:["{","}"],directivePrefix:"tpl-"},f=function(){function t(e,i){r(this,t),this.template=o(e),this.cfg=n.assign(n.clone(p),i||{});var s=this.cfg.delimiter[0],c=this.cfg.delimiter[1];this.delimiterReg=new RegExp(s+"([^"+s+c+"]*)"+c,"g"),this.attrDirectiveTestReg=new RegExp("^"+this.cfg.directivePrefix)}return t.prototype.complie=function(t){return new h(this,t)},t}(),h=function(){function t(e,i){if(r(this,t),!(e instanceof f))throw TypeError("Invalid Template "+e);this.template=e,this.bind=i,this.directives=[],this.el=this.template.template.clone(),this.init()}return t.prototype.init=function(){var t=this;n.each(this.el,function(e){t._parse(e)}),this.directives.forEach(function(e){t.bind=e.bind()})},t.prototype._parse=function(t){switch(t.nodeType){case 1:this._parseElement(t);break;case 3:this._parseText(t)}},t.prototype._parseDirectiveName=function(t){var e=this.template.attrDirectiveTestReg;return e.test(t)?t.replace(e,""):void 0},t.prototype._parseElement=function(t){var e=this,i=!1;o(t);t.attributes&&n.each(t.attributes,function(r){var n=r.name,o=r.value,s=void 0,u=void 0;(n=e._parseDirectiveName(n))&&(s=c.getDirective(n))?(u=new s(t,e.bind,o),e.directives.push(u),u.isBlock()&&(i=!0)):n&&console.warn("Directive is undefined "+r.name)}),i||n.each(t.childNodes,function(t){e._parse(t)})},t.prototype._parseText=function(t){for(var e=t.data,i=void 0,r=0,n=this.template.delimiterReg;i=n.exec(e);)this._createTextNode(e.substr(r,n.lastIndex-i[0].length),t),this._createComment(i[0],t),this.directives.push(new a(this._createTextNode("binding",t),this.bind,i[1])),r=n.lastIndex;this._createTextNode(e.substr(r),t),o(t).remove()},t.prototype._createComment=function(t,e){var i=document.createComment(t);return o(i).insertBefore(e),i},t.prototype._createTextNode=function(t,e){if(t){var i=document.createTextNode(t);return o(i).insertBefore(e),i}return void 0},t}();f.Directive=c,f.Directives=s,f.Expression=u,t.exports=f},function(e,i){e.exports=t},function(t,i){t.exports=e},function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var o=i(4),s=i(6),c=o.AbstractDirective,u=function(t){function e(i,n,o){r(this,e),t.call(this,i,n,o),this.expression=new s(n,o),this.update=this.update.bind(this)}return n(e,t),e.prototype.bind=function(){var t=this.expression.observe(this.update);return this.update(),t},e.prototype.unbind=function(){return this.expression.unobserve(this.update)},e.prototype.getValue=function(){return this.expression.getValue()},e.prototype.update=function(){throw"Abstract Method ["+this.getDirectiveClassName()+".unbind]"},e}(c);e.ExprDirective=u;var a=function(t){function e(){r(this,e),t.apply(this,arguments)}return n(e,t),e.prototype.update=function(){this.el.data=this.getValue()},e}(u);e.TextNodeDirective=a;var p=function(t){function e(){r(this,e),t.apply(this,arguments)}return n(e,t),e.prototype.update=function(){$(this.el).text(this.getValue()||"")},e}(u);e.TextDirective=p;var f=function(t){function e(){r(this,e),t.apply(this,arguments)}return n(e,t),e.prototype.update=function(){$(this.el).html(this.getValue()||"")},e}(u);e.HtmlDirective=f;var h=function(t){function e(){r(this,e),t.apply(this,arguments)}return n(e,t),e.prototype.update=function(){var t=this.getValue();$(this.el).addClass(t)},e}(u);e.ClassDirective=h;var l=function(t){function e(){r(this,e),t.apply(this,arguments)}return n(e,t),e.prototype.update=function(){$(this.el).css("display",this.getValue()?"":"none")},e}(u);e.ShowDirective=l;var d=function(t){function e(){r(this,e),t.apply(this,arguments)}return n(e,t),e.prototype.update=function(){$(this.el).css("display",this.getValue()?"none":"")},e}(u);e.HideDirective=d;var v=function(t){function e(){r(this,e),t.apply(this,arguments)}return n(e,t),e.prototype.isBlock=function(){return!0},e}(c);e.IfDirective=v,o.register("class",h)},function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t){if(!t)return!1;for(var e=t;e=Object.getPrototypeOf(e);)if(e===u)return!0;return!1}function o(t,e){t in a&&console.warn("Directive["+t+"] is defined");var i=void 0;if(c.isPlainObject(e))i=function(e){var i=c.isFunction(e.constructor)?e.constructor:void 0;delete e.constructor;var r=function(){return function(){if(!(this instanceof u))throw new TypeError("Cannot call a class as a function");u.apply(this,arguments),i&&i.apply(this,arguments)}}();return r.prototype=Object.create(u.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0},directiveName:{value:t,enumerable:!1,writable:!1,configurable:!1}}),Object.setPrototypeOf(r,u),r}(e);else{if(!n(e))throw TypeError("Invalid Directive Object "+e);i=e}return a[t]=i,i}function s(t){return a[t]}var c=i(1),u=(i(2),i(5),function(){function t(e,i,n){r(this,t),this.el=e,this.nodeType=e.nodeType,this.target=i,this.expr=n,this.directiveName||(this.directiveName=this.constructor.name)}return t.prototype.getDirectiveClassName=function(){return this.constructor.name?this.constructor.name:c.capitalize(this.directiveName)+"Directive"},t.prototype.bind=function(){throw"Abstract Method ["+this.getDirectiveClassName()+".bind]"},t.prototype.unbind=function(){throw"Abstract Method ["+this.getDirectiveClassName()+".unbind]"},t.prototype.isBlock=function(){return!1},t}()),a={};t.exports={AbstractDirective:u,register:o,getDirective:s}},function(t,e){t.exports=i},function(t,e,i){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=i(1),o=function(){function t(e,i){r(this,t),this.bind=e,this.expression=i}return t.prototype.getValue=function(){return n.get(this.bind,this.expression)},t.prototype.observe=function(t){return observer.observe(this.bind,this.expression,t)},t.prototype.unobserve=function(t){return observer.unobserve(this.bind,this.expression,t)},t}();t.exports=o}])});