!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("_"),require("jquery"),require("observer")):"function"==typeof define&&define.amd?define(["_","jquery","observer"],e):"object"==typeof exports?exports.tpl=e(require("_"),require("jquery"),require("observer")):t.tpl=e(t._,t.jQuery,t.observer)}(this,function(t,e,n){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var i=n(1);i.Directives=n(10),i.expression=n(7),t.exports=i},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},o=n(2),s=n(3),a=n(4),c=n(8),p=c.Directive,u=c.DirectiveGroup,l=function(t){return new RegExp([t[0],"([^",t[0],t[0],"]*)",t[1]].join(""),"g")},h=function(t){return new RegExp("^"+t)},f={delimiter:["{","}"],directivePrefix:"tpl-"},d=0,y=function(){function t(e,n){i(this,t),this.template=s(e),n=n||{},this.directivePrefix=n.directivePrefix||f.directivePrefix,this.delimiter=n.delimiter||f.delimiter,this.directiveReg=h(this.directivePrefix),this.delimiterReg=l(this.delimiter),this.__instance_nr__=0,this.__id__=d++}return t.prototype.complie=function(t,e){return new v(this,t,e)},t}(),v=function(){function t(e,n,r){i(this,t),this.tpl=e,this.scope=n,this.el=this.tpl.template.clone(),this.parent=r,this.__id__=e.__id__+"-"+e.__instance_nr__++,this.init()}return t.prototype.renderTo=function(t){return s(t).append(this.el),this},t.prototype.init=function(){var t=this;this.bindings=this.parse(this.el),this.bindings.forEach(function(e){e.bind(),t.scope=e.scope})},t.prototype.parse=function(t){var e=this;if(!(t.jquery||t instanceof Array))return this.parseEl(t);var n=function(){var n=[];return o.each(t,function(t){n.push.apply(n,e.parseEl(t))}),{v:n}}();return"object"===("undefined"==typeof n?"undefined":r(n))?n.v:void 0},t.prototype.parseEl=function(t){switch(t.nodeType){case 1:return this.parseElement(t);case 3:return this.parseText(t)}},t.prototype.parseText=function(t){for(var e=t.data,n=void 0,i=0,r=this.tpl.delimiterReg,o=[];n=r.exec(e);)this.createTextNode(e.substring(i,r.lastIndex-n[0].length),t),n[1]&&o.push(new a(this.createTextNode("binding",t),this,n[1])),i=r.lastIndex;return this.createTextNode(e.substr(i),t),s(t).remove(),o},t.prototype.createTextNode=function(t,e){if(t=o.trim(t)){var n=document.createTextNode(t);return s(n).insertBefore(e),n}},t.prototype.parseElement=function(t){var e=this,n=!1,i=(s(t),[]),r=[];return t.attributes&&(o.each(t.attributes,function(t){var i=t.name,o=t.value,s=void 0;if((i=e.parseDirectiveName(i))&&(s=p.getDirective(i))){if(s.prototype["abstract"])return r=[{"const":s,val:o}],n=!0,!1;r.push({"const":s,val:o}),s.prototype.block&&(n=!0)}else i&&console.warn("Directive is undefined "+t.name)}),r.length>1?i.push(new u(t,this,r)):1==r.length&&i.push(new r[0]["const"](t,this,r[0].val))),n||i.push.apply(i,this.parseChildNodes(t)),i},t.prototype.parseChildNodes=function(t){return this.parse(o.slice(t.childNodes,0))},t.prototype.parseDirectiveName=function(t){var e=this.tpl.directiveReg;return e.test(t)?t.replace(e,""):void 0},t}();t.exports=y},function(e,n){e.exports=t},function(t,n){t.exports=e},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=(n(2),n(3)),a=n(5),c=a.Binding,p=n(7),u=["$scope","$el"],l=function(t){function e(n,o,s){i(this,e);var a=r(this,t.call(this,o,s));return a.el=n,a.observeHandler=a.observeHandler.bind(a),a.expression=p.parse(a.expr,u),a}return o(e,t),e.prototype.value=function(){return this.applyFilter(this.expression.execute.call(this.scope,this,this.scope,this.el))},e.prototype.bind=function(){var t=this;c.generateComments&&!this.comment&&(this.comment=s(document.createComment("Text Binding "+this.expr)),this.comment.insertBefore(this.el)),this.expression.identities.forEach(function(e){t.observe(e,t.observeHandler)}),this.update(this.value())},e.prototype.unbind=function(){var t=this;this.expression.identities.forEach(function(e){t.unobserve(e,t.observeHandler)})},e.prototype.observeHandler=function(t,e){this.expression.simplePath?this.update(this.applyFilter(e)):this.update(this.value())},e.prototype.update=function(t){void 0!==t&&null!==t||(t=""),this.el.data=t},e}(c);t.exports=l},function(t,e,n){"use strict";function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var s=n(2),a=n(6),c=e.AbstractBinding=function(){function t(e){o(this,t),this.tpl=e,this.scope=e.scope,this.ancestorObservers={}}return t.prototype.destroy=function(){},t.prototype._createObserveAncestorHandler=function(t,e,n,i){var r=this,o=arguments,s=function c(){i.apply(r,o);for(var n=t.length-1;n>=e;n--)a.un(t[n],c),t.pop()};return s},t.prototype._has=function(t,e){},t.prototype.observe=function(t,e){for(var n=this.tpl,i=[this.scope],r=void 0;!s.has(n.scope,t)&&(n=n.parent);)i.push(n.scope);if(a.on(i.shift(),t,e),r=i.length){var o=this.ancestorObservers[t],c=[];o||(o=this.ancestorObservers[t]={ancestors:i.map(function(t){return a.obj(t)}),callbacks:[],fns:[]}),o.callbacks.push(e),o.fns.push(c);for(var p=0;r>p;p++)a.on(i[p],t,c[p]=this._createObserveAncestorHandler(i,p,t,e))}},t.prototype.unobserve=function(t,e){a.un(this.scope,t,e);var n=this.ancestorObservers[t];if(n){var i=n.callbacks.indexOf(e),r=void 0;if(-1!=i){var o=this.tpl;for(r=n.fns[i],i=0;i<r.length;i++)o=o.parent,a.un(o.scope,r[i])}}},t.prototype.get2=function(t){for(var e=this.tpl,n=this.scope;!s.has(n,t);){if(e=e.parent,!e)return{scope:void 0,data:void 0};n=e.scope}return{scope:n,data:s.get(n,t)}},t.prototype.get=function(t){for(var e=this.tpl,n=this.scope;!s.has(n,t);){if(e=e.parent,!e)return;n=e.scope}return s.get(n,t)},t.prototype.set=function(t,e){s.set(this.scope,t,e)},t.prototype.bind=function(){throw"Abstract Method ["+this.constructor.name+".bind]"},t.prototype.unbind=function(){throw"Abstract Method ["+this.constructor.name+".unbind]"},t}(),p=/((?:'[^']*')*(?:(?:[^\|']+(?:'[^']*')*[^\|']*)+|[^\|]+))|^$/g,u=e.Binding=function(t){function e(n,r){o(this,e);var s=i(this,t.call(this,n));s.fullExpr=r;var a=r.match(p);return s.expr=a.shift(),s.filterExprs=a,s.filters=[],s}return r(e,t),e.prototype.applyFilter=function(t){for(var e=0;e<this.filters.length;e++)t=this.filters[e].apply(t);return t},e.prototype.unapplyFilter=function(t){for(var e=0;e<this.filters.length;e++)t=this.filters[e].unapply(t);return t},e}(c);u.generateComments=!0},function(t,e){t.exports=n},function(t,e,n){"use strict";function i(t,e){var n=T.length;return T[n]=e?t.replace(g,"\\n"):t,'"'+n+'"'}function r(t,e){return T[e]}function o(t){var e=t.charAt(0);if(t=t.slice(1),v.test(t))return t;if(l){var n=t.match(k);if(n&&-1!=l.indexOf(n))return t}t=t.replace(w,r),u[t]=1;var i="binding.get2('"+t+"')",o=void 0;return(o=h[i])||(o=h[i]=f++),e+"__$"+o+"__.data"}function s(t){var e=t.charAt(t.length-1);return e=")"==e?e:","+e,t=t.slice(0,t.indexOf(".")),t=t+".data.call("+t+".scope"+e}function a(t,e){if(m.test(t))throw Error("Invalid expression. Generated function body: "+t);l=e,h={},f=0;var n=t.replace(_,i).replace(x,"");n=(" "+n).replace($,o).replace(j,s).replace(w,r);var a=[];d.each(h,function(t,e){a.push("  var __$"+t+"__ = "+e+";\n")}),T.length=0,l=void 0,h=void 0,n=a.join("")+"  return "+n+";";var c=["binding"];e&&c.push.apply(c,e),c.push(n);try{return Function.apply(Function,c)}catch(p){throw Error("Invalid expression. Generated function body: "+n)}}function c(t){return E.test(t)&&!O.test(t)}function p(t,e){t=t.trim();var n={exp:t};return c(t)?(n.simplePath=!0,n.identities=[t],n.execute=function(e){return e.get(t)}):(n.simplePath=!1,u={},n.execute=a(t,e),n.identities=Object.keys(u),u=void 0),n}e.__esModule=!0,e.isSimplePath=c,e.parse=p;var u,l,h,f,d=n(2),y="Math,Date,this,true,false,null,undefined,Infinity,NaN,isNaN,isFinite,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,parseInt,parseFloat",v=new RegExp("^("+y.replace(/,/g,"\\b|")+"\\b)"),b="break,case,class,catch,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,let,return,super,switch,throw,try,var,while,with,yield,enum,await,implements,package,proctected,static,interface,private,public",m=new RegExp("^("+b.replace(/,/g,"\\b|")+"\\b)"),x=/\s/g,g=/\n/g,_=/[\{,]\s*[\w\$_]+\s*:|('(?:[^'\\]|\\.)*'|"(?:[^"\\]|\\.)*"|`(?:[^`\\]|\\.)*\$\{|\}(?:[^`\\]|\\.)*`|`(?:[^`\\]|\\.)*`)|new |typeof |void /g,w=/"(\d+)"/g,E=/^[A-Za-z_$][\w$]*(?:\.[A-Za-z_$][\w$]*|\['.*?'\]|\[".*?"\]|\[\d+\]|\[[A-Za-z_$][\w$]*\])*$/,$=/[^\w$\.:][A-Za-z_$][\w$]*(?:\.[A-Za-z_$][\w$]*|\['.*?'\]|\[".*?"\]|\[\d+\]|\[[A-Za-z_$][\w$]*\])*/g,O=/^(?:true|false)$/,k=/^[A-Za-z_$][\w$]*/,j=/__\$[\d]+__\.data\(./g,T=[]},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}e.__esModule=!0;var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},a=n(2),c=n(3),p=n(5),u=p.Binding,l=p.AbstractBinding,h=n(9),f=h.ArrayIterator,d=h.YieId,y="extend",v=(e.DirectiveGroup=function(t){function e(n,o,s){i(this,e);var a=r(this,t.call(this,o));return a.el=n,s.sort(function(t,e){return e["const"].prototype.priority-t["const"].prototype.priority||0}),a.directives=s.map(function(t){return new t["const"](n,o,t.val)}),a}return o(e,t),e.prototype.bind=function(){function t(){for(var i=void 0,r=void 0;e.hasNext();)if(i=e.next(),r=i.bind(),n.scope=i.scope,e.hasNext()&&r&&r instanceof d){r.then(t);break}}var e=new f(this.directives),n=this;t()},e.prototype.unbind=function(){var t=this;this.directives.forEach(function(e){e.unbind(),t.scope=e.scope})},e}(l),e.Directive=function(t){function e(n,o,s){i(this,e);var a=r(this,t.call(this,o,s));return a.el=n,a.$el=c(n),a.attr=o.tpl.directivePrefix+a.name,a}return o(e,t),e.prototype.bind=function(){u.generateComments&&!this.comment&&(this.comment=c(document.createComment(" Directive:"+this.name+" ["+this.expr+"] ")),this.comment.insertBefore(this.el))},e.prototype.unbind=function(){},e}(u));v.prototype["abstract"]=!1,v.prototype.name="Unkown",v.prototype.block=!1,v.prototype.priority=0;var b={},m=v.isDirective=function(t){var e="undefined"==typeof t?"undefined":s(t);if(!t||"function"!=e&&"object"!=e)return!1;for(var n=t;n=Object.getPrototypeOf(n);)if(n===v)return!0;return!1};v.getDirective=function(t){return b[t]},v.register=function(t,e){t in b&&console.warn("Directive["+t+"] is defined");var n=void 0;if(a.isPlainObject(e))n=function(t,e){var n=t[y];if(n&&!m(n))throw"Invalid Directive SuperClass "+n;e=n||e;var i=a.isFunction(t.constructor)?t.constructor:void 0,r=function(){var t=function(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");e.apply(this,arguments),i&&i.apply(this,arguments)};return t}();return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),delete t.constructor,delete t[y],a.each(t,function(t,e){r.prototype[e]=t}),Object.setPrototypeOf(r,e),r}(e,v),n.prototype.className=a.capitalize(t)+"Directive";else{if(!m(e))throw TypeError("Invalid Directive Object "+e);n=e,n.prototype.className=n.prototype.constructor.name}return n.prototype.name=t,b[t]=n,n}},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var r=n(2);e.YieId=function(){function t(){i(this,t),this._doned=!1,this._thens=[]}return t.prototype.then=function(t){r.include(this._thens,t)||this._thens.push(t)},t.prototype.done=function(){this._doned||(r.each(this._thens,function(t){return t()}),this._doned=!0)},t.prototype.isDone=function(){return this._doned},t}(),e.ArrayIterator=function(){function t(e,n){i(this,t),this.array=e,this.index=n||0}return t.prototype.hasNext=function(){return this.index<this.array.length},t.prototype.next=function(){return this.array[this.index++]},t}()},function(t,e,n){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(e,n){var i=u.register(e,n);t.exports[i.prototype.className]=i}e.__esModule=!0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},c=n(2),p=n(8),u=p.Directive,l=n(1),h=n(7),f=n(9),d=f.YieId,y=["$scope","$el"],v=["$scope","$el","$event"],b=e.AbstractEventDirective=function(t){function e(n,o,s){i(this,e);var a=r(this,t.call(this,n,o,s));return a.handler=a.handler.bind(a),a.expression=h.parse(a.expr,v),a}return o(e,t),e.prototype.handler=function(t){var e=this.expression.execute.call(this.scope,this,this.scope,this.el,t);"function"==typeof e&&e.call(this.scope,this.scope,this.el,t)},e.prototype.bind=function(){t.prototype.bind.call(this),this.$el.on(this.eventType,this.handler)},e.prototype.unbind=function(){t.prototype.unbind.call(this),this.$el.un(this.eventType,this.handler)},e}(u),m=["blur","change","click","dblclick","error","focus","keydown","keypress","keyup","load","mousedown","mousemove","mouseout","mouseover","mouseup","resize","scroll","select","submit","unload",{name:"oninput",eventType:"input propertychange"}];c.each(m,function(t){var e=void 0;c.isString(t)?(e="on"+t,t={eventType:t}):e=t.name,t.extend=b,s(e,t)});var x=e.AbstractExpressionDirective=function(t){function e(n,o,s){i(this,e);var a=r(this,t.call(this,n,o,s));return a.observeHandler=a.observeHandler.bind(a),a.expression=h.parse(a.expr,y),a}return o(e,t),e.prototype.setRealValue=function(t){this.set(this.expr,t)},e.prototype.realValue=function(){return this.expression.execute.call(this.scope,this,this.scope,this.el)},e.prototype.setValue=function(t){return this.setRealValue(this.unapplyFilter(t))},e.prototype.value=function(){return this.applyFilter(this.realValue())},e.prototype.bind=function(){var e=this;t.prototype.bind.call(this),console.log(this.className+": ["+this.expr+"] ",this.expression.identities),this.expression.identities.forEach(function(t){e.observe(t,e.observeHandler)}),this.update(this.value())},e.prototype.unbind=function(){var e=this;t.prototype.unbind.call(this),this.expression.identities.forEach(function(t){e.unobserve(t,e.observeHandler)})},e.prototype.blankValue=function(t){return 0==arguments.length&&(t=this.value()),void 0===t||null==t?"":t},e.prototype.observeHandler=function(t,e){this.expression.simplePath?this.update(this.applyFilter(e)):this.update(this.value())},e.prototype.update=function(t){throw"Abstract Method ["+this.className+".update]"},e}(u),g="change",_="input propertychange",w="click",E="SELECT",$="INPUT",O="TEXTAREA",k="radio",j="checkbox",T={text:{update:function(t){this.$el.text(this.blankValue(t))},block:!0},html:{update:function(t){this.$el.html(this.blankValue(t))},block:!0},"class":{update:function(t){t&&"string"==typeof t?this.handleArray(t.trim().split(/\s+/)):t instanceof Array?this.handleArray(t):t&&"object"==("undefined"==typeof t?"undefined":a(t))?this.handleObject(t):this.cleanup()},handleObject:function(t){this.cleanup(t);var e=this.prevKeys=[];for(var n in t)t[n]?(this.$el.addClass(n),e.push(n)):this.$el.removeClass(n)},handleArray:function(t){this.cleanup(t);for(var e=this.prevKeys=[],n=0,i=t.length;i>n;n++)t[n]&&(e.push(t[n]),this.$el.addClass(this.el,t[n]))},cleanup:function(t){if(this.prevKeys)for(var e=this.prevKeys.length,n=t instanceof Array;e--;){var i=this.prevKeys[e];t&&(n?-1==t.indexOf(i):!t.hasOwnProperty(i))||this.$el.removeClass(i)}}},show:{update:function(t){this.$el.css("display",t?"":"none")}},hide:{update:function(t){this.$el.css("display",t?"none":"")}},value:{update:function(t){this.$el.val(this.blankValue(t))}},checked:{update:function(t){this.$el.prop("checked",!!t)}},"if":{bind:function(){return x.prototype.bind.call(this),this.directives?void 0:(this.yieId=new d,this.yieId)},update:function(t){var e=this;t?(this.directives||(this.directives=this.tpl.parseChildNodes(this.el),this.directives.forEach(function(t){t.bind(),e.scope=t.scope}),this.yieId&&(this.yieId.done(),delete this.yieId)),this.$el.css("display","")):this.$el.css("display","none")},unbind:function(){var t=this;x.prototype.unbind.call(this),this.directives&&this.directives.forEach(function(e){e.unbind(),t.scope=e.scope})},priority:9,block:!0},input:{constructor:function(t,e,n){x.call(this,t,e,n),this.onChange=this.onChange.bind(this);var i=this.tag=t.tagName;switch(i){case E:this.event=g;break;case $:var r=this.type=t.type;this.event=r==k||r==j?w:_;break;case O:throw TypeError("Directive[input] not support "+i);default:throw TypeError("Directive[input] not support "+i)}},bind:function(){x.prototype.bind.call(this),this.$el.on(this.event,this.onChange)},unbind:function(){x.prototype.unbind.call(this),this.$el.un(this.event,this.onChange)},onChange:function(){var t=this.elVal();t!=this.val&&this.setValue(t)},update:function(t){this.val=this.blankValue(t),this.elVal(this.val)},elVal:function(t){var e=this.tag;switch(e){case E:break;case $:var n=this.type;if(n==k||n==j){if(0==arguments.length)return this.$el.prop("checked")?this.$el.val():void 0;var i=c.isString(t)?t==this.$el.val():!!t;this.$el.prop("checked")!=i&&this.$el.prop("checked",i)}else{if(0==arguments.length)return this.$el.val();t!=this.$el.val()&&this.$el.val(t)}break;case O:throw TypeError("Directive[input] not support "+e);default:throw TypeError("Directive[input] not support "+e)}}}};c.each(T,function(t,e){t.extend=x,s(e,t)});var A=/^\s*([\S][\s\S]+[\S])\s+in\s+([\S]+)(\s+track\s+by\s+([\S]+))?\s*$/,S=/^(\(\s*([\S]+)(\s*,\s*([\S]+))?\s*\))|([\S]+)(\s*,\s*([\S]+))$/,C=e.EachDirective=function(t){function e(n,o,s){i(this,e);var a=r(this,t.call(this,n,o,s));a.observeHandler=a.observeHandler.bind(a),a.lengthObserveHandler=a.lengthObserveHandler.bind(a);var c=s.match(A);if(!c)throw Error("Invalid Expression["+s+"] on Each Directive");a.scopeExpr=c[2],a.indexExpr=c[4];var p=c[1].match(S);if(!p)throw Error("Invalid Expression["+c[1]+"] on Each Directive");return a.valueAlias=p[2]||p[5],a.keyAlias=p[4]||p[7],a.$parentEl=a.$el.parent(),a.$el.remove().removeAttr(a.attr),a.childTpl=new l(a.$el),a}return o(e,t),e.prototype.bindChild=function(t,e){var n={__index__:this.indexExpr?c.get(e,this.indexExpr):t};this.keyAlias&&(n[this.keyAlias]=t),n[this.valueAlias]=e;this.childTpl.complie(n,this.tpl).renderTo(this.$parentEl)},e.prototype.bind=function(){t.prototype.bind.call(this),this.observe(this.scopeExpr,this.observeHandler),this.observe(this.scopeExpr+".length",this.lengthObserveHandler),this.update(this.target())},e.prototype.unbind=function(){t.prototype.unbind.call(this),this.unobserve(this.scopeExpr,this.observeHandler),this.unobserve(this.scopeExpr+".length",this.lengthObserveHandler)},e.prototype.update=function(t){if(t instanceof Array)for(var e=0;e<t.length;e++)this.bindChild(e,t[e]);else console.warn("Invalid Each Scope["+this.scopeExpr+"] "+t)},e.prototype.target=function(){return this.get(this.scopeExpr)},e.prototype.observeHandler=function(t,e){this.update(e)},e.prototype.lengthObserveHandler=function(){this.update(this.target())},e}(u);C.prototype["abstract"]=!0,C.prototype.block=!0,C.prototype.priority=10,u.register("each",C)}])});