!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("tpl",t):e.tpl=t()}(this,function(){function e(e){var t=(new Date).getTime(),n=Math.max(0,16-(t-qe)),i=setTimeout(function(){e(t+n)},n);return qe=t+n,i}function t(e){clearTimeout(e)}function n(e,t,n){e.prototype[t]||(e.prototype[t]=n)}function i(e){l(e)&&(Ke=e)}function r(){return Ke}function o(e,t){return Ke.call(e,t)}function s(e){return void 0!==e}function a(e){return null===e}function c(e){return void 0===e||null===e}function u(e){return Me.call(e)===ze}function l(e){return Me.call(e)===Ge}function h(e){return Me.call(e)===We}function p(e){return Me.call(e)===Ye}function f(e){return Me.call(e)===Ue}function d(e){return Me.call(e)===Ze}function v(e){return Me.call(e)===Je}function g(e){return Me.call(e)===Qe}function y(e){var t=Me.call(e);switch(t){case Xe:case ze:case Ze:case et:return!0;default:if(e){var n=e.length;return h(n)&&(n?n>0&&n-1 in e:0===n)}return!1}}function m(e,t,n,i){var r=void 0,s=void 0;n=n||e;for(r in e)if(s=o(e,r),(i===!1||s)&&t.call(n,e[r],r,e,s)===!1)return!1;return!0}function b(e,t,n){var i=0,r=e.length;for(n=n||e;i<r;i++)if(t.call(n,e[i],i,e,!0)===!1)return!1;return!0}function x(e,t,n,i){return y(e)?b(e,t,n):!!c(e)||m(e,t,n,i)}function w(e,t,n,i){function r(e,n){o[n]=t.apply(this,arguments)}var o=void 0;return y(e)?(o=[],b(e,r,n)):(o={},c(e)||m(e,r,n,i)),o}function E(e,t,n,i){var r=void 0;return y(e)?(r=[],b(e,function(e){t.apply(this,arguments)&&r.push(e)},n)):(r={},c(e)||m(e,function(e,n){t.apply(this,arguments)&&(r[n]=e)},n,i)),r}function _(e,t,n,i,r){var o=n;return x(e,function(e,n,i,r){o=t.call(this,o,e,n,i,r)},i,r),o}function P(e,t,n,i){var r=[];return x(e,function(e,n){t&&!t.apply(this,arguments)||r.push(n)},n,i),r}function C(e,t){for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1}function T(e,t){for(var n=e.length;n-- >0;)if(e[n]===t)return n}function S(e,t,n){for(key in e)if((n===!1||o(e,key))&&e[key]===t)return key}function O(e,t,n){return y(e)?C(e,t):S(e,t,n)}function j(e,t,n){return y(e)?T(e,t):S(e,t,n)}function k(e,t,n,i,r){var o={};return x(e,function(e,i){o[t?t.apply(this,arguments):i]=n?n.apply(this,arguments):e},i,r),o}function A(e,t,n,i){var r={};return x(e,function(e,n){r[e]=t?t.apply(this,arguments):n},n,i),r}function N(e){return e.toUpperCase()}function F(e){return e.replace(tt,N)}function L(e){return e.replace(nt,"")}function D(e){return e.replace(it,"")}function $(e){return e.replace(rt,"")}function I(e,t,n,i){var r=e.length>=t?"":Array(1+t-e.length>>>0).join(n);return i?e+r:r+e}function R(e,t,n,i,r){var o=i-e.length;return o>0?n||!r?I(e,i," ",n):e.slice(0,t.length)+I("",o,"0",!0)+e.slice(t.length):e}function H(e){return B(e,Array.prototype.slice.call(arguments,1)).format}function B(e,t){var n=0;return e=e.replace(ot,function(e,i,r,o,s,a,c){if("%%"==e)return"%";var u=!1,l="",h=!1,p=!1;if(r&&x(r,function(e){switch(e){case" ":l=" ";break;case"+":l="+";break;case"-":u=!0;break;case"0":h=!0;break;case"#":p=!0}}),o=o?"*"==o?+t[n++]:"*"==o.charAt(0)?+t[o.slice(1,-1)]:+o:0,o<0&&(o=-o,u=!0),!isFinite(o))throw new Error("sprintf: (minimum-)width must be finite");a&&"*"==a.charAt(0)&&(a=+t["*"==a?n++:a.slice(1,-1)],a<0&&(a=null)),a=null==a?"fFeE".indexOf(c)>-1?6:"d"==c?0:void 0:+a;var f=i?t[i.slice(0,-1)]:t[n++],d=void 0,v=void 0;switch(c){case"c":f=String.fromCharCode(+f);case"s":f=String(f),null!=a&&(f=f.slice(0,a)),d="";break;case"b":v=2;break;case"o":v=8;break;case"u":v=10;break;case"x":case"X":v=16;break;case"i":case"d":var g=parseInt(+f);if(isNaN(g))return"";d=g<0?"-":l,f=d+I(String(Math.abs(g)),a,"0",!1);break;case"e":case"E":case"f":case"F":case"g":case"G":case"p":case"P":var y=+f;if(isNaN(y))return"";d=y<0?"-":l;var m=void 0;if("p"!=c.toLowerCase())m=["toExponential","toFixed","toPrecision"]["efg".indexOf(c.toLowerCase())];else{var b=String(f).replace(/[eE].*|[^\d]/g,"");b=(y?b.replace(/^0+/,""):b).length,a=a?Math.min(a,b):a,m=!a||a<=b?"toPrecision":"toExponential"}var w=Math.abs(y)[m](a);f=d+w;break;case"n":return"";default:return e}if(v){var E=f>>>0;d=p&&10!=v&&E&&["0b","0","0x"][v>>3]||"",f=d+I(E.toString(v),a||0,"0",!1)}var _=R(f,d,u,o,h);return"EFGPX".indexOf(c)>-1?_.toUpperCase():_}),{format:e,formatArgCount:n}}function q(e,t){if(u(e))return e;if(!d(e))return[];var n=function(){var n=st[e];return n?{v:n}:(n=t?st[e]=[]:[],e.replace(at,function(e,t,i,r){n.push(i?r.replace(ct,"$1"):t||e)}),{v:n})}();return"object"==typeof n?n.v:void 0}function V(e,t,n,i,r){for(var s=0,a=q(t,!0),u=a.length-1,l=void 0;!c(e)&&s<u;){if(l=a[s++],r&&!o(e,l))return n;e=e[l]}return l=a[s],s==u&&!c(e)&&(r?o(e,l):l in e)?e[l]:n}function M(e,t,n,i){for(var r=0,s=q(t,!0),a=s.length-1,u=void 0;!c(e)&&r<a;){if(u=s[r++],i&&!o(e,u))return!1;e=e[u]}return u=s[r],r==a&&!c(e)&&(i?o(e,u):u in e)}function K(e,t,n){for(var i=0,r=q(t,!0),o=r.length-1,s=r[0],a=e;i<o;i++)a=c(a[s])?a[s]={}:a[s],s=r[i+1];return a[s]=n,e}function X(e,t){return o(e,t)?e[t]:void 0}function z(e){for(var t=void 0,n=void 0,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(n in t)o(t,n)&&!o(e,n)&&(e[n]=t[n])}return e}function G(){}function Y(e,t){if(!l(e))return e instanceof t;for(var n=e;(n=ut(n))&&n!==Object;)if(n===t)return!0;return t===Object}function W(e){var t=function(){this.constructor.apply(this,arguments)},n=e.extend,i=void 0,r=void 0;return ht(t,ft),l(n)&&n!==Object||(n=ft),i=n.prototype,r=pt(i),t.superclass=i,t.prototype=r,lt(t,n),delete e.extend,t.extend(e)}function U(e){return U.proxy(e)}function Z(e){var t=e!==Tt?function(e,t){U[t]=e}:function(e,t){U[t]=Et.emptyFunc};Et.each(St,t),Et.each(e,function(e,t){U[t]=e})}function J(e,t,n){var i=Et.getOwnProp(e,At.observerKey);return!!i&&(1==arguments.length?i.hasListen():2==arguments.length?i.hasListen(t):i.hasListen(t,n))}function Q(e,t,n){var i=Et.getOwnProp(e,At.observerKey);return i||(e=U.obj(e),i=new Nt(e),e[At.observerKey]=i),i.on(t,n)}function ee(e,t,n){var i=Et.getOwnProp(e,At.observerKey);return i&&(e=2==arguments.length?i.un(t):i.un(t,n),!i.hasListen())?(e[At.observerKey]=void 0,i.destroy()):e}function te(e){return"_"!=e[0]&&"-"!=e[0]||(e=e[1]),e.toUpperCase()}function ne(e,t,n){return zt.each(t,function(t,i){e[n[i]||i]=t}),e}function ie(e){return Yt.isArrayLike(e)?e[0]:e}function re(e){return Yt.isArrayLike(e)?e[e.length-1]:e}function oe(e,t){Yt.isArrayLike(e)?Yt.each(e,t):t(e)}function se(e,t,n,i){return n?(Ut.prop(e,t),Ut):Ut.prop(e,t)}function ae(e){return!e||e.indexOf("-")<0&&e.indexOf("_")<0?e:e.replace(/[-_][^-_]/g,function(e){return e.charAt(1).toUpperCase()})}function ce(e,t,n){if(Qt[e])return Qt[e];t=t||on.style;for(var i=0,r=nn.length;i<r;i++)if(n=ae(nn[i]+e),n in t)return Qt[e]=n;return null}function ue(e){for(var t=e.offsetParent;t&&"static"===sn(t,"position");)t=t.offsetParent;return t||on}function le(e){var t={left:0,top:0};if(!e||!e.tagName||!e.ownerDocument)return t;var n=e.ownerDocument,i=n.body,r=n.documentElement,o=n.defaultView||n.parentWindow;if(!Ut.inDoc(e,r))return t;e.getBoundingClientRect&&(t=e.getBoundingClientRect());var s=r.clientTop||i.clientTop,a=r.clientLeft||i.clientLeft,c=Math.max(o.pageYOffset||0,r.scrollTop,i.scrollTop),u=Math.max(o.pageXOffset||0,r.scrollLeft,i.scrollLeft);return{top:t.top+c-s,left:t.left+u-a}}function he(e){return e.window&&e.document?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}function pe(e){return Yt.isNil(e)||NaN===e?"":Yt.isString(e)?e:e+""}function fe(e,t,n,i){if(!Yt.isFunc(n))throw TypeError("Invalid Event Handler");var r=e[mn],o=void 0;return r||(e[mn]=r={}),(o=r[t])||(r[t]=o=[]),o.push({handler:n,once:i}),1===o.length}function de(e,t,n){var i=e[mn],r=i?i[t]:void 0;if(r)for(var o=0,s=r.length;o<s;o++)if(r[o].handler===n)return r.splice(o,1),1===s;return!1}function ve(e,t){var n=e[mn],i=n?n[t]:void 0;return i?i.slice():void 0}function ge(e,t,n){var i=e[mn],r=i?i[t]:void 0;return!!r&&(n?Yt.indexOf(r,n)!=-1:!!r.length)}function ye(e,t,n){var i=Pn[t];i&&i.bind&&i.bind(e,t,n)===!1||bn(e,i?i.type||t:t,_e,!!_n[t])}function me(e,t,n){var i=Pn[t];i&&i.unbind&&i.unbind(e,t,n)===!1||xn(e,i?i.type||t:t,_e)}function be(e,t){Tn[e]?Tn[e]++:(ye(un,e,t),Tn[e]=1)}function xe(e,t){Tn[e]&&(Tn[e]--,Tn[e]||me(un,e,t))}function we(e,t,n){var i=ve(e,t.type);if(i){t.currentTarget=e;var r=void 0,o=void 0,s=void 0;for(o=0,s=i.length;o<s&&!t.isImmediatePropagationStopped;o++){if(r=i[o],n){var a=new Date;a-Sn>16&&(r.handler.call(e,t),Sn=a)}else r.handler.call(e,t);r.once&&Ut.off(e,t.type,r.handler)}}}function Ee(e,t,n){if(e.disabled!==!0||"click"!==t){var i=/move|scroll/.test(t);if(En[t])for(;e&&e.getAttribute&&!n.cancelBubble;)we(e,n,i),e=e.parentNode;else we(e,n,i)}}function _e(e){e=new yn(e);var t=e.type,n=e.target;if(Cn[t]){t=Cn[t];var i=Pn[t];if(i&&i.fix&&i.fix(n,e)===!1)return;e.type=t,Ee(n,t,e)}else Ee(n,t,e)}function Pe(e){for(jn=!0;e=On.shift();)e()}function Ce(e,t,n,i){var r=Dn[e],o=r?r.type:void 0,s=void 0;return s=r?i!==!1?r.apply:r.unapply:void 0,s?(Yt.isFunc(n)&&(n=n()),t=s.apply(r,[t].concat(n))):Fn.warn("filter["+e+"]."+(i!==!1?"apply":"unapply")+" is undefined"),{stop:"event"==o&&t===!1,data:t,replaceData:"event"!==o}}function Te(e,t){var n=Wn.length;return Wn[n]=t?e.replace(Vn,"\\n"):e,'"'+n+'"'}function Se(e,t){return Wn[t]}function Oe(e,t,n){var i=e.length,r=e.charAt(i-1),o=e.slice(0,i-1),s=o.match(Yn)[0];return Bn[s]||Zn[s]?e:"$context"===s?e.replace(Yn,Jn):"("==r?(r=t+i==n.length||")"==n.charAt(t+i)?"":",",Jn="this.propScope('"+s+"')","$scope."+o+".call("+Jn+r):(Un[o]=!0,"$scope."+o+r)}function je(e){return Jn=void 0,(e+" ").replace(Gn,Oe).replace(Kn,Se)}function ke(e,t){for(var n=0,i=e.length;n<i;n++)e[n]=Le(je(e[n]),t);return e}function Ae(e,t){if(!e||!e.length)return[];for(var n=[],i=void 0,r=void 0,o=0,s=e.length;o<s;o++)(i=Yt.trim(e[o]))&&(r=i.replace(/,?\s+/g,",").split(","),n.push({name:r.shift().replace(Kn,Se),args:ke(r,t)}));return n}function Ne(e,t){var n=void 0,i=void 0,r=De(e);return Un={},Zn=t?Yt.reverseConvert(t,function(){return!0}):{},r||(n=e.replace(Mn,Te).split("|"),e=n.shift().replace(qn,""),r=De(e)),r?(e=e.replace(Kn,Se),Un[e]=!0,i={execute:Le("$scope."+e,t),path:Yt.parseExpr(e),expr:e}):i={execute:Le(je(e),t),expr:e},i.filters=Ae(n,t),i.simplePath=r,i.identities=Yt.keys(Un),Zn=void 0,Un=void 0,Wn.length=0,i.applyFilter=function(e,t,n,r){for(var o=i.filters,s=void 0,a=void 0,c=void 0,u=0,l=o.length;u<l;u++){if(s=o[u],a=Fe(s.args,t,n),c=(r!==!1?$n.apply:$n.unapply)(s.name,e,a),c.stop)return c.data;c.replaceData&&(e=c.data)}return e},i.executeAll=function(){var e=i.execute.apply(this,arguments);return e=i.applyFilter(e,this,arguments)},i}function Fe(e,t,n){return Yt.map(e,function(e){return e.apply(t,n)})}function Le(e,t){var n=["$scope"];t=t?n.concat(t):n,t.push("return "+e+";");try{return Function.apply(Function,t)}catch(i){throw Error("Invalid expression. Generated function body: "+e)}}function De(e){return Xn.test(e)&&!zn.test(e)}function $e(e,t){var n=void 0;return e=Yt.trim(e),(n=Qn[e])||(Qn[e]=n=Ne(e,t)),n}function Ie(e,t){if(Yt.isString(e)){if(e=Yt.trim(e),"<"==e.charAt(0)){var n=document.createElement("div");return Ut.html(n,e),n.childNodes}e=Ut.query(e)}return t?Ut.cloneNode(e):e}function Re(e,t){return e[t]||An.get(t)}function He(e,t){if(Yt.isString(e)){if(e=Yt.trim(e),"<"==e.charAt(0)){var n=document.createElement("div");return Ut.html(n,e),n.childNodes}e=Ut.query(e)}return t?Ut.cloneNode(e):e}function Be(e,t){return e[t]||An.get(t)}var qe=void 0,Ve={request:e,cancel:t};window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||Ve.request,window.cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||Ve.cancel,n(Function,"bind",function(e){var t=this,n=Array.prototype.slice.call(arguments,1);return function(){return t.apply(e,n.concat(Array.prototype.slice.call(arguments)))}}),Object.freeze||(Object.freeze=function(e){return e});var Me=Object.prototype.toString,Ke=Object.prototype.hasOwnProperty,Xe="[object Arguments]",ze="[object Array]",Ge="[object Function]",Ye="[object Boolean]",We="[object Number]",Ue="[object Date]",Ze="[object String]",Je="[object Object]",Qe="[object RegExp]",et="[object NodeList]",tt=/^[a-z]/,nt=/^\s+/,it=/\s+$/,rt=/(^\s+)|(\s+$)/g,ot=/%%|%(\d+\$)?([-+#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuidfegpEGP])/g,st={},at=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,ct=/\\(\\)?/g,ut=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__},lt=Object.setPrototypeOf||function(e,t){e.__proto__=t},ht=Object.assign||function(e){for(var t=void 0,n=void 0,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(n in t)o(t,n)&&(e[n]=t[n])}return e},pt=Object.create||function(e,t){G.prototype=e;var n=new G;return G.prototype=void 0,t&&x(t,function(e,t){n[t]=e.value}),n},ft=function(){};ht(ft.prototype,{"super":function(e){var t=arguments.callee.caller;t.$owner.superclass[t.$name].apply(this,e)},superclass:function(){var e=arguments.callee.caller;return e.$owner.superclass}}),ht(ft,{extend:function(e){var t=this;return e&&!function(){var n=t.prototype;x(e,function(e,i){l(e)&&(e.$owner=t,e.$name=i),n[i]=e}),t.assign(e.statics)}(),this},assign:function(e){return e&&ht(this,e),this}});var dt=Object.freeze({overrideHasOwnProlicy:i,hasOwnProlicy:r,hasOwnProp:o,isDefine:s,isNull:a,isNil:c,isArray:u,isFunc:l,isNumber:h,isBool:p,isDate:f,isString:d,isObject:v,isRegExp:g,isArrayLike:y,each:x,map:w,filter:E,aggregate:_,keys:P,indexOf:O,lastIndexOf:j,convert:k,reverseConvert:A,upperFirst:F,ltrim:L,rtrim:D,trim:$,format:H,_format:B,parseExpr:q,get:V,has:M,set:K,getOwnProp:X,prototypeOf:ut,setPrototypeOf:lt,assign:ht,assignIf:z,emptyFunc:G,create:pt,isExtendOf:Y,dynamicClass:W}),vt=W({constructor:function(e){this.cfg=e||{}},register:function(e,t){var n=this;return 1==arguments.length?x(e,function(e,t){n.cfg[t]=e}):this.cfg[e]=t,this},config:function(e){var t=this;return e&&x(this.cfg,function(n,i){o(e,i)&&(t.cfg[i]=e[i])}),this},get:function(e){return arguments.length?this.cfg[e]:pt(this.cfg)}}),gt=["debug","info","warn","error"],yt=document.createElement("div"),mt=Array.prototype.slice,bt=W({constructor:function(){yt.innerHTML='<div id="simulation_console"\n    style="position:absolute; top:0; right:0; font-family:courier,monospace; background:#eee; font-size:10px; padding:10px; width:200px; height:200px;">\n  <a style="float:right; padding-left:1em; padding-bottom:.5em; text-align:right;">Clear</a>\n  <div id="simulation_console_body"></div>\n</div>',this.el=yt.childNodes[0],this.clearEl=this.el.childNodes[0],this.bodyEl=this.el.childNodes[1]},appendTo:function(e){e.appendChild(this.el)},log:function(e,t){yt.innerHTML='<span style="'+e+'">'+t+"</span>",this.bodyEl.appendChild(yt.childNodes[0])},parseMsg:function(e){var t=e[0];if(d(t)){var n=B.apply(null,e);return[n.format].concat(mt.call(e,n.formatArgCount)).join(" ")}return e.join(" ")},debug:function(){this.log("color: red;",this.parseMsg(arguments))},info:function(){this.log("color: red;",this.parseMsg(arguments))},warn:function(){this.log("color: red;",this.parseMsg(arguments))},error:function(){this.log("color: red;",this.parseMsg(arguments))},clear:function(){this.bodyEl.innerHTML=""}}),xt=window.console;xt&&!xt.debug&&(xt.debug=function(){Function.apply.call(xt.log,xt,arguments)});var wt=W({statics:{enableSimulationConsole:function(){xt||(xt=new bt,xt.appendTo(document.body))}},constructor:function(e,t){this.module=e,this.level=O(gt,t||"info")},setLevel:function(e){this.level=O(gt,e||"info")},getLevel:function(){return gt[this.level]},_print:function(e,t,n){Function.apply.call(xt[e],xt,t),n&&xt.trace&&xt.trace()},_log:function(e,t,n){if(!(e<this.level)&&xt){var i="[%s] %s -"+(d(t[0])?" "+t.shift():""),r=[];t=E(t,function(e){return!(e instanceof Error)||(r.push(e),!1)}),x(r,function(e){t.push.call(t,e.message,"\n",e.stack)}),e=gt[e],this._print(e,[i,e,this.module].concat(t),n)}},debug:function(){this._log(0,mt.call(arguments,0))},info:function(){this._log(1,mt.call(arguments,0))},warn:function(){this._log(2,mt.call(arguments,0))},error:function(){this._log(3,mt.call(arguments,0))}});wt.logger=new wt("default","info");var Et=z({timeoutframe:Ve,Configuration:vt,Logger:wt},dt),_t=new Et.Configuration,Pt=Object.prototype.hasOwnProperty,Ct="proxyListenKey";_t.register(Ct,"__PROXY_LISTENERS__");var Tt={eq:function(e,t){return e===t},obj:function(e){return e},proxy:function(e){return e}},St={change:function(e,t){var n=Et.getOwnProp(e,_t.get(Ct));if(n)for(var i=n.length;i--;)n[i](e,t)},on:function(e,t){if(!Et.isFunc(t))throw TypeError("Invalid Proxy Event Handler["+t);var n=_t.get(Ct),i=Et.getOwnProp(e,n);i||(e[n]=i=[]),i.push(t)},un:function(e,t){var n=Et.getOwnProp(e,_t.get(Ct));if(n&&Et.isFunc(t))for(var i=n.length;i-- >0;)if(n[i]===t)return n.splice(i,1),!0;return!1},clean:function(e){e[U.listenKey]&&(e[U.listenKey]=void 0)}},Ot=!1;Et.assign(U,{isEnable:function(){return U.on!==Et.emptyFunc},enable:function(e){Z(e),Ot||(Et.overrideHasOwnProlicy(function(e){return Pt.call(U.obj(this),e)}),Et.get=function(e,t,n,i,r){for(var o=0,s=Et.parseExpr(t,!0),a=s.length-1,c=void 0;!Et.isNil(e)&&o<a;){if(c=s[o++],e=U.obj(e),r&&!Pt.call(e,c))return n;e=e[c]}return e=U.obj(e),c=s[o],o==a&&!Et.isNil(e)&&(r?Pt.call(e,c):c in e)?e[c]:n},Ot=!0)},disable:function(){Z(Tt)}}),U.disable();var jt=new Et.Logger("observer","info"),kt=Et.timeoutframe,At=_t.get();_t.register({lazy:!0,animationFrame:!0,observerKey:"__OBSERVER__",expressionKey:"__EXPR_OBSERVER__"});var Nt=Et.dynamicClass({constructor:function(e){this.target=e,this.obj=e,this.listens={},this.changeRecords={},this._notify=this._notify.bind(this),this.watchPropNum=0,this._init()},_fire:function(e,t,n){var i=this,r=this.listens[e];!r||U.eq(t,n)&&!Et.isArray(t)||Et.each(r.slice(),function(r){r(e,t,n,i.target)})},_notify:function(){var e=this,t=this.obj,n=this.changeRecords;this.request_frame=void 0,this.changeRecords={},Et.each(n,function(n,i){e._fire(i,t[i],n)})},_addChangeRecord:function(e,t){At.lazy?e in this.changeRecords||(this.changeRecords[e]=t,this.request_frame||(this.request_frame=At.animationFrame?window.requestAnimationFrame(this._notify):kt.request(this._notify))):this._fire(e,this.obj[e],t)},checkHandler:function(e){if(!Et.isFunc(e))throw TypeError("Invalid Observe Handler")},hasListen:function(e,t){switch(arguments.length){case 0:return!!this.watchPropNum;case 1:return Et.isFunc(e)?!Et.each(this.listens,function(t){return Et.lastIndexOf(t,e)!==-1}):!!this.listens[e];default:return this.checkHandler(t),Et.lastIndexOf(this.listens[e],t)!==-1}},on:function(e,t){var n=void 0;return this.checkHandler(t),(n=this.listens[e])?n.push(t):(this.listens[e]=[t],this.watchPropNum++,this._watch(e)),this.target},_cleanListen:function(e){this.listens[e]=void 0,this.watchPropNum--,this._unwatch(e)},un:function(e,t){var n=this.listens[e];if(n)if(1==arguments.length)this._cleanListen(e);else{this.checkHandler(t);for(var i=n.length;i--;)if(n[i]===t){n.splice(i,1),n.length||this._cleanListen(e);break}}return this.target},destroy:function(){this.request_frame&&(At.animationFrame?window.cancelAnimationFrame(this.request_frame):kt.cancel(this.request_frame),this.request_frame=void 0);var e=this.obj;return this._destroy(),this.obj=void 0,this.target=void 0,this.listens=void 0,this.changeRecords=void 0,e},_init:Et.emptyFunc,_destroy:Et.emptyFunc,_watch:Et.emptyFunc,_unwatch:Et.emptyFunc}),Ft=0,Lt=Et.dynamicClass({constructor:function(e,t,n){this.id=Ft++,this.expr=t,this.handlers=[],this.observers=[],this.path=n||Et.parseExpr(t),this.observeHandlers=this._initObserveHandlers(),this.obj=U.obj(e),this.target=this._observe(this.obj,0),U.isEnable()&&(this._onTargetProxy=this._onTargetProxy.bind(this),U.on(e,this._onTargetProxy))},_onTargetProxy:function(e,t){this.target=t},_observe:function(e,t){var n=this.path[t],i=void 0;return t+1<this.path.length&&(i=e[n])&&(i=this._observe(U.obj(i),t+1),U.isEnable()&&(e[n]=i)),Q(e,n,this.observeHandlers[t])},_unobserve:function(e,t){var n=this.path[t],i=void 0,r=void 0;return r=ee(e,n,this.observeHandlers[t]),t+1<this.path.length&&(i=e[n])&&(i=this._unobserve(U.obj(i),t+1),U.isEnable()&&(e[n]=i)),r},_initObserveHandlers:function(){return Et.map(this.path,function(e,t){return this._createObserveHandler(t)},this)},_createObserveHandler:function(e){var t=this,n=this.path.slice(0,e+1),i=this.path.slice(e+1),r=this.path.length-e-1;return function(o,s,a){if(r){if(s){var c=U.obj(s),u=t.obj;if(s=Et.get(c,i),c=t._observe(c,e+1),U.isEnable()){for(var l=0;l<e;)if(u=U.obj(u[n[l++]]),!u)return;u[n[l]]=c}}else s=void 0;if(a?(a=U.obj(a),t._unobserve(a,e+1),a=Et.get(a,i)):a=void 0,U.eq(s,a))return}Et.each(t.handlers.slice(),function(e){e(this.expr,s,a,this.target)},t)}},checkHandler:function(e){if(!Et.isFunc(e))throw TypeError("Invalid Observe Handler")},on:function(e){return this.checkHandler(e),this.handlers.push(e),this},un:function(e){if(arguments.length){this.checkHandler(e);for(var t=this.handlers,n=t.length;n--;)if(t[n]===e){t.splice(n,1);break}}else this.handlers=[];return this},hasListen:function(e){return arguments.length?Et.lastIndexOf(this.handlers,e)!=-1:!!this.handlers.length},destory:function(){U.un(this.target,this._onTargetProxy);var e=this._unobserve(this.obj,0);return this.obj=void 0,this.target=void 0,this.expr=void 0,this.handlers=void 0,this.path=void 0,this.observers=void 0,this.observeHandlers=void 0,this.target=void 0,e}}),Dt=[],$t=!1,It={registerPolicy:function(e,t,n,i){return Dt.push({name:e,priority:t,policy:i,checker:n}),Dt.sort(function(e,t){return e.priority-t.priority}),jt.info("register observe policy[%s], priority is %d",e,t),this},init:function(e){if(!$t){if(_t.config(e),Et.each(Dt,function(e){if(e.checker(At))return Et.each(e.policy(At),function(e,t){Nt.prototype[t]=e}),At.policy=e.name,jt.info("apply observe policy[%s], priority is %d",e.name,e.priority),!1})!==!1)throw Error("observer is not supported");$t=!0}return this},on:function(e,t,n){var i=Et.parseExpr(t);if(i.length>1){var r=Et.getOwnProp(e,At.expressionKey),o=r?r[t]:void 0;return o||(o=new Lt(e,t,i),r||(r=e[At.expressionKey]={}),r[t]=o),o.on(n),o.target}return Q(e,t,n)},un:function(e,t,n){var i=Et.parseExpr(t);if(i.length>1){var r=Et.getOwnProp(e,At.expressionKey),o=r?r[t]:void 0;return o?(2==arguments.length?o.un():o.un(n),o.hasListen()?o.target:(r[t]=void 0,o.destory())):U.proxy(e)||e}return 2==arguments.length?ee(e,t):ee(e,t,n)},hasListen:function(e,t,n){var i=arguments.length;switch(i){case 1:return J(e);case 2:if(Et.isFunc(t))return J(e,t)}var r=Et.parseExpr(t);if(r.length>1){var o=Et.getOwnProp(e,At.expressionKey),s=o?o[t]:void 0;return!!s&&(2==i||s.hasListen(n))}return J.apply(window,arguments)}};_t.register({es6Proxy:!0,es6SourceKey:"__ES6_PROXY_SOURCE__",es6ProxyKey:"__ES6_PROXY__"});var Rt=Object.prototype.hasOwnProperty;It.registerPolicy("ES6Proxy",1,function(e){return window.Proxy&&e.es6Proxy!==!1},function(e){var t=e.es6SourceKey,n=e.es6ProxyKey;return U.enable({obj:function(e){return e&&Rt.call(e,t)?e[t]:e},eq:function(e,t){return e===t||e&&t&&U.obj(e)===U.obj(t)},proxy:function(e){return e&&Rt.call(e,n)?e[n]:e}}),{_init:function(){this.obj=U.obj(this.target),this.es6proxy=!1},_destroy:function(){this.es6proxy=!1,this.obj[n]=void 0,U.change(this.obj,void 0)},_watch:function(e){if(!this.es6proxy){var i=this._objectProxy(),r=this.obj;this.target=i,r[n]=i,r[t]=r,U.change(r,i),this.es6proxy=!0}},_unwatch:function(e){},_objectProxy:function(){var e=this;return new Proxy(this.obj,{set:function(t,n,i){if(e.listens[n]){var r=t[n];t[n]=i,e._addChangeRecord(n,r)}else t[n]=i;return!0}})}}});var Ht=Object.prototype.hasOwnProperty,Bt="hasOwnProperty,toString,toLocaleString,isPrototypeOf,propertyIsEnumerable,valueOf".split(","),qt="concat,copyWithin,entries,every,fill,filter,find,findIndex,forEach,indexOf,lastIndexOf,length,map,keys,join,pop,push,reverse,reverseRight,some,shift,slice,sort,splice,toSource,unshift".split(","),Vt=Et.dynamicClass({constBind:"__VB_CONST__",descBind:"__VB_PROXY__",classNameGenerator:0,constructor:function(e,t){this.classPool={},this.defPropMap={},this.onProxyChange=t,this.addDefProps(e),this.initConstScript()},setConstBind:function(e){this.constBind=e,this.initConstScript()},setDescBind:function(e){this.descBind=e,this.initConstScript()},addDefProps:function(e){var t=this.defPropMap,n=[];Et.each(e||[],function(e){t[e]=!0});for(var i in t)Ht.call(t,i)&&n.push(i);this.defProps=n,jt.info("VBProxy default props is: ",n.join(",")),this.initReserveProps()},initReserveProps:function(){this.reserveProps=Bt.concat(this.defProps),this.reserveArrayProps=this.reserveProps.concat(qt),this.reservePropMap=Et.reverseConvert(this.reserveProps),this.reserveArrayPropMap=Et.reverseConvert(this.reserveArrayProps)},initConstScript:function(){this.constScript=["\tPublic [",this.descBind,"]\r\n","\tPublic Default Function [",this.constBind,"](desc)\r\n","\t\tset [",this.descBind,"] = desc\r\n","\t\tSet [",this.constBind,"] = Me\r\n","\tEnd Function\r\n"].join("")},generateClassName:function(){return"VBClass"+this.classNameGenerator++},parseClassConstructorName:function(e){return e+"Constructor"},generateSetter:function(e){var t=this.descBind;return["\tPublic Property Get [",e,"]\r\n","\tOn Error Resume Next\r\n","\t\tSet[",e,"] = [",t,'].get("',e,'")\r\n',"\tIf Err.Number <> 0 Then\r\n","\t\t[",e,"] = [",t,'].get("',e,'")\r\n',"\tEnd If\r\n","\tOn Error Goto 0\r\n","\tEnd Property\r\n"]},generateGetter:function(e){var t=this.descBind;return["\tPublic Property Let [",e,"](val)\r\n","\t\tCall [",t,'].set("',e,'",val)\r\n',"\tEnd Property\r\n","\tPublic Property Set [",e,"](val)\r\n","\t\tCall [",t,'].set("',e,'",val)\r\n',"\tEnd Property\r\n"]},generateClass:function(e,t,n){var i=this,r=["Class ",e,"\r\n",this.constScript,"\r\n"];return Et.each(t,function(e){n[e]?r.push("\tPublic ["+e+"]\r\n"):(r.push.apply(r,i.generateSetter(e)),r.push.apply(r,i.generateGetter(e)))}),r.push("End Class\r\n"),r.join("")},generateClassConstructor:function(e,t,n){var i=[e.length,"[",e.join(","),"]","[",n.join(","),"]"].join(""),r=this.classPool[i];if(r)return r;var o=this.generateClassName();return r=this.parseClassConstructorName(o),parseVB(this.generateClass(o,e,t)),parseVB(["Function ",r,"(desc)\r\n","\tDim o\r\n","\tSet o = (New ",o,")(desc)\r\n","\tSet ",r," = o\r\n","End Function"].join("")),this.classPool[i]=r,r},create:function(e,t){function n(t){Et.isFunc(e[t])&&(c[t]=!0,a.push(t)),s.push(t)}var i=this,r=void 0,o=void 0,s=[],a=[],c={},u=this.descBind;return Et.isArray(e)?(r=this.reserveArrayProps,o=this.reserveArrayPropMap):(r=this.reserveProps,o=this.reservePropMap),Et.each(r,n),Et.each(e,function(e,t){t===u||t in o||n(t)},e,!1),t||(t=this.descriptor(e),t?e=t.obj:t=new Mt(e,s,this)),proxy=window[this.generateClassConstructor(s,c,a)](t),Et.each(a,function(t){proxy[t]=i.funcProxy(e[t],proxy)}),t.proxy=proxy,this.onProxyChange(e,proxy),proxy},funcProxy:function(e,t){return function(){e.apply(this&&this!=window?this:t,arguments)}},eq:function(e,t){var n=this.descriptor(e),i=this.descriptor(t);return n&&(e=n.obj),i&&(t=i.obj),e===t},obj:function(e){var t=this.descriptor(e);return t?t.obj:e},proxy:function(e){var t=this.descriptor(e);return t?t.proxy:void 0},isProxy:function(e){return Ht.call(e,this.constBind)},descriptor:function(e){var t=this.descBind;return Ht.call(e,t)?e[t]:void 0},destroy:function(e){var t=this.descriptor(e);return t&&(e=t.obj,this.onProxyChange(e,void 0)),e}}),Mt=Et.dynamicClass({constructor:function(e,t,n){this.classGenerator=n,this.obj=e,this.defines=Et.reverseConvert(t,function(){return!1}),e[n.descBind]=this,this.accessorNR=0},isAccessor:function(e){return e&&(e.get||e.set)},hasAccessor:function(){return!!this.accessorNR},defineProperty:function(e,t){var n=this.defines,i=this.obj;return e in n||(e in i?Et.isFunc(i[e])&&console.warn("defineProperty not support function ["+e+"]"):i[e]=void 0,this.classGenerator.create(this.obj,this)),this.isAccessor(t)?(n[e]=t,this.accessorNR++,t.get&&(i[e]=t.get())):(n[e]&&(n[e]=!1,this.accessorNR--),i[e]=t.value),this.proxy},getPropertyDefine:function(e){return this.defines[e]||void 0},get:function(e){var t=this.defines[e];return t&&t.get?t.get.call(this.proxy):this.obj[e]},set:function(e,t){var n=this.defines[e];n&&n.set&&n.set.call(this.proxy,t),this.obj[e]=t}}),Kt=void 0;Vt.isSupport=function(){if(void 0!==Kt)return Kt;if(Kt=!1,window.VBArray)try{window.execScript(["Function parseVB(code)","\tExecuteGlobal(code)","End Function"].join("\n"),"VBScript"),Kt=!0}catch(e){console.error(e.message,e)}return Kt},_t.register({defaultProps:[]});var Xt={_init:function(){this.watchers={}},_destroy:function(){for(var e in this.watchers)this.watchers[e]&&this._unwatch(e);this.watchers=void 0},_watch:function(e){this.watchers[e]||(this._defineProperty(e,this.obj[e]),this.watchers[e]=!0)},_unwatch:function(e){this.watchers[e]&&this._undefineProperty(e,this.obj[e])}};It.registerPolicy("ES5DefineProperty",10,function(e){if(Object.defineProperty)try{var t=function(){var e=void 0,t={};return Object.defineProperty(t,"sentinel",{get:function(){return e},set:function(t){e=t}}),t.sentinel=1,{v:t.sentinel===e}}();if("object"==typeof t)return t.v}catch(n){}return!1},function(e){return U.disable(),Et.assignIf({_defineProperty:function(e,t){var n=this;Object.defineProperty(this.target,e,{enumerable:!0,configurable:!0,get:function(){return t},set:function(i){var r=t;t=i,n._addChangeRecord(e,r)}})},_undefineProperty:function(e,t){Object.defineProperty(this.target,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}},Xt)}),It.registerPolicy("DefineGetterAndSetter",20,function(e){return"__defineGetter__"in{}},function(e){return U.disable(),Et.assignIf({_defineProperty:function(e,t){var n=this;this.target.__defineGetter__(e,function(){return t}),this.target.__defineSetter__(e,function(i){var r=t;t=i,n._addChangeRecord(e,r)})},_undefineProperty:function(e,t){this.target.__defineGetter__(e,function(){return t}),this.target.__defineSetter__(e,function(e){t=e})}},Xt)}),It.registerPolicy("VBScriptProxy",30,function(e){return Vt.isSupport()},function(e){var t=Xt._init,n=void 0;return U.enable({obj:function(e){return e?n.obj(e):e},eq:function(e,t){return e===t||e&&t&&n.obj(e)===n.obj(t)},proxy:function(e){return e?n.proxy(e):e}}),n=It.vbfactory=new Vt([e.proxyListenKey,e.observerKey,e.expressionKey].concat(e.defaultProps||[]),U.change),Et.assignIf({_init:function(){t.call(this),this.obj=n.obj(this.target)},_defineProperty:function(e,t){var i=this,r=this.obj,o=n.descriptor(r);o||(o=n.descriptor(n.create(r))),this.target=o.defineProperty(e,{set:function(t){var n=i.obj[e];i.obj[e]=t,i._addChangeRecord(e,n)}})},_undefineProperty:function(e,t){var i=this.obj,r=n.descriptor(i);r&&(this.target=r.defineProperty(e,{value:t}),r.hasAccessor()||(this.target=n.destroy(i)))}},Xt)});var zt=Et.assign({eq:function(e,t){return U.eq(e,t)},obj:function(e){return U.obj(e)},onproxy:function(e,t){return U.on(e,t)},unproxy:function(e,t){return U.un(e,t)},proxy:U,config:_t.get()},Et,It),Gt=/(^[a-z])|([_-][a-zA-Z])/g,Yt=ne({hump:function(e){return e.replace(Gt,te)},YieId:zt.dynamicClass({constructor:function(){this.doned=!1,this.thens=[]},then:function(e){this.doned?e():this.thens.push(e)},done:function(){if(!this.doned){for(var e=this.thens,t=0,n=e.length;t<n;t++)e[t]();this.doned=!0}},isDone:function(){return this.doned}})},zt,{on:"observe",un:"unobserve",hasListen:"isObserved"}),Wt="string"==typeof document.createElement("div").textContent?"textContent":"innerText",Ut={W3C:!!window.dispatchEvent,inDoc:function(e,t){if(t=t||document.documentElement,t.contains)return t.contains(e);try{for(;e=e.parentNode;)if(e===t)return!0}catch(n){}return!1},query:function(e,t){return Yt.isString(e)?t?document.querySelectorAll(e):document.querySelector(e):e;
},cloneNode:function(e,t){function n(e){return e.cloneNode(t!==!1)}return Yt.isArrayLike(e)?Yt.map(e,n):n(e)},parent:function(e){return ie(e).parentNode},next:function(e,t){return e=re(e),t?e.nextSibling:e.nextElementSibling},prev:function(e,t){return e=ie(e),t?e.previousSibling:e.previousElementSibling},children:function(e,t){return e=ie(e),t?e.childNodes:e.children},remove:function(e){return oe(e,function(e){var t=e.parentNode;t&&t.removeChild(e)}),Ut},before:function(e,t){t=ie(t);var n=t.parentNode;return oe(e,function(e){n.insertBefore(e,t)}),Ut},after:function(e,t){t=re(t);var n=t.parentNode;return oe(e,n.lastChild===t?function(e){n.insertBefore(e,t)}:function(){var e=t.nextSibling;return function(t){n.insertBefore(t,e)}}()),Ut},append:function(e,t){return e=ie(e),oe(t,function(t){e.appendChild(t)}),Ut},prepend:function(e,t){return e.firstChild?Ut.before(t,t.firstChild):Ut.append(e,t),Ut},replace:function(e,t){var n=e.parentNode;n.replaceChild(t,e)},html:function(e,t){return arguments.length>1?e.innerHTML=t:e.innerHTML},outerHtml:function(e){if(e.outerHTML)return e.outerHTML;var t=document.createElement("div");return t.appendChild(e.cloneNode(!0)),t.innerHTML},text:function(e,t){return 3==e.nodeType?arguments.length>1?e.data=t:e.data:arguments.length>1?e[Wt]=t:e[Wt]},focus:function(e){return e.focus(),Ut}};document.querySelectorAll||(document.querySelectorAll=function(e){var t=document,n=t.documentElement.firstChild,i=t.createElement("STYLE");if(n.appendChild(i),t.__qsaels=[],i.styleSheet)i.styleSheet.cssText=e+"{x:expression(document.__qsaels.push(this))}";else{var r=document.createTextNode(e+"{x:expression(document.__qsaels.push(this))}");i.appendChild(r)}return window.scrollBy(0,0),t.__qsaels}),document.querySelector||(document.querySelector=function(e){var t=document.querySelectorAll(e);return t.length?t[0]:null});var Zt=/^(?:input|select|textarea|button|object)$/i,Jt=/^(?:a|area)$/i;Yt.assign(Ut,{prop:function(e,t,n){t=Ut.propFix[t]||t;var i=Ut.propHooks[t];return 2==arguments.length?i&&i.get?i.get(e,t):e[t]:(i&&i.set?i.set(e,t,n):e[t]=n,Ut)},attr:function(e,t,n){return 2==arguments.length?e.getAttribute(t):(e.setAttribute(t,n),Ut)},removeAttr:function(e,t){return e.removeAttribute(t),Ut},checked:function(e,t){return se(e,"checked",arguments.length>1,t)},"class":function(e,t){return se(e,"class",arguments.length>1,t)},addClass:function(e,t){if(e.classList)e.classList.add(t);else{var n=" "+Ut.prop(e,"class")+" ";n.indexOf(" "+t+" ")===-1&&Ut["class"](e,Yt.trim(n+t))}return Ut},removeClass:function(e,t){return e.classList?e.classList.remove(t):Ut["class"](e,Yt.trim((" "+Ut.prop(e,"class")+" ").replace(new RegExp(" "+t+" ","g"),""))),Ut},style:function(e,t){return se(e,"style",arguments.length>1,t)},propHooks:{tabIndex:{get:function(e){var t=e.getAttributeNode("tabindex");return t&&t.specified?parseInt(t.value,10):Zt.test(e.nodeName)||Jt.test(e.nodeName)&&e.href?0:void 0}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"}}),Yt.assign(Ut,{css:function(e,t,n){var i=/[_-]/.test(t)?ae(t):t,r=void 0;if(t=ce(i)||i,r=en[i]||tn,2==arguments.length){var o=n,s=void 0;return"background"===t&&(t="backgroundColor"),n=r.get(e,t),o!==!1&&isFinite(s=parseFloat(n))?s:n}return n||0===n?(isFinite(n)&&!rn[i]&&(n+="px"),r.set(e,t,n)):e.style[t]="",Ut},position:function(e){var t=void 0,n=void 0,i={top:0,left:0};return"fixed"===Ut.css(e,"position")?n=e.getBoundingClientRect():(t=ue(e),n=le(e),"HTML"!==t.tagName&&(i=le(t)),i.top+=Ut.css(t,"borderTopWidth",!0),i.left+=Ut.css(t,"borderLeftWidth",!0),i.top-=Ut.scrollTop(t),i.left-=Ut.scrollLeft(t)),{top:n.top-i.top-Ut.css(e,"marginTop",!0),left:n.left-i.left-Ut.css(e,"marginLeft",!0)}},scrollTop:function(e,t){var n=he(e);return 1==arguments.length?(n?"scrollTop"in n?n.scrollTop:on.pageYOffset:e.pageYOffset)||0:(n?n.scrollTo(Ut.scrollLeft(e),t):e.pageYOffset=t,Ut)},scrollLeft:function(e,t){var n=he(e);return 1==arguments.length?(n?"scrollLeft"in n?n.scrollLeft:on.pageXOffset:e.pageXOffset)||0:(n?n.scrollTo(t,Ut.scrollTop(e)):e.pageXOffset=t,Ut)},scroll:function(e,t,n){var i=he(e);return 1==arguments.length?{left:Ut.scrollLeft(e),top:Ut.scrollTop(e)}:(i?i.scrollTo(t,n):(e.pageXOffset=t,e.pageYOffset=n),Ut)}});var Qt=Ut.cssFix={"float":Ut.W3C?"cssFloat":"styleFloat"},en=Ut.cssHooks={},tn={},nn=["","-webkit-","-o-","-moz-","-ms-"],rn={animationIterationCount:!0,columnCount:!0,order:!0,flex:!0,flexGrow:!0,flexShrink:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},on=document.documentElement,sn=Ut.css;tn.set=function(e,t,n){try{e.style[t]=n}catch(i){}};var an=void 0;window.getComputedStyle?(an=tn.get=function(e,t){var n=void 0,i=getComputedStyle(e,null);return i&&(n="filter"===t?i.getPropertyValue(t):i[t],""===n&&(n=e.style[t])),n},en.opacity={get:function(e,t){var n=an(e,t);return""===n?"1":ret}}):!function(){var e=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,t=/^(top|right|bottom|left)$/,n=/alpha\([^)]*\)/i,i=!!window.XDomainRequest,r="DXImageTransform.Microsoft.Alpha",o={thin:i?"1px":"2px",medium:i?"3px":"4px",thick:i?"5px":"6px"};an=tn.get=function(n,i){var r=n.currentStyle,s=r[i];if(e.test(s)&&!t.test(s)){var a=n.style,c=a.left,u=n.runtimeStyle.left;n.runtimeStyle.left=r.left,a.left="fontSize"===i?"1em":s||0,s=a.pixelLeft+"px",a.left=c,n.runtimeStyle.left=u}return"medium"===s&&(i=i.replace("Width","Style"),"none"===r[i]&&(s="0px")),""===s?"auto":o[s]||s},en.opacity={get:function(e,t){var n=e.filters.alpha||e.filters[r],i=n&&n.enabled?n.opacity:100;return i/100+""},set:function(e,t,i){var r=e.style,o=isFinite(i)&&i<=1?"alpha(opacity="+100*i+")":"",s=r.filter||"";r.zoom=1,r.filter=(n.test(s)?s.replace(n,o):s+" "+o).trim(),r.filter||r.removeAttribute("filter")}}}(),Yt.each(["top","left"],function(e){en[e]={get:function(e,t){var n=an(e,t);return/px$/.test(n)?n:Ut.position(e)[t]+"px"}}}),Yt.each(["Width","Height"],function(e){function t(e,t){var n=void 0;return n=e[i],2===t?n+sn(e,"margin"+r[0],!0)+sn(e,"margin"+r[1],!0):(t<0&&(n=n-sn(e,"border"+r[0]+"Width",!0)-sn(e,"border"+r[1]+"Width",!0)),t===-4&&(n=n-sn(e,"padding"+r[0],!0)-sn(e,"padding"+r[1],!0)),n)}var n=e.toLowerCase(),i="offset"+e,r="Width"==e?["Left","Right"]:["Top","Bottom"];Ut[n]=function(e){return t(e,-4)},Ut["inner"+e]=function(e){return t(e,-2)},Ut["outer"+e]=function(e,n){return t(e,n===!0?2:0)}}),Yt.assign(Ut,{val:function(e,t){var n=Ut.valHooks[e.type||e.tagName.toLowerCase()];return 1==arguments.length?n&&n.get?n.get(e):e.value||"":(n&&n.set?n.set(e,t):e.value=pe(t),Ut)},valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t="select-one"==e.type,n=e.selectedIndex;if(n<0)return t?void 0:[];for(var i=e.options,r=void 0,o=t?void 0:[],s=0,a=i.length;s<a;s++)if(r=i[s],r.selected||s==n){if(t)return Ut.val(r);o.push(Ut.val(r))}return o},set:function(e,t){var n="select-one"==e.type,i=e.options,r=void 0,o=void 0,s=void 0,a=void 0,c=void 0;if(e.selectedIndex=-1,Yt.isArray(t)||(t=Yt.isNil(t)?[]:[t]),a=t.length){n&&(a=t.length=1);var u=Yt.reverseConvert(t,function(){return!1}),l=0;for(o=0,s=i.length;o<s&&(r=i[o],c=Ut.val(r),!Yt.isBoolean(u[c])||(u[c]=r.selected=!0,++l!==a));o++)t=Yt.keys(u,function(e){return e===!0})}return n?t[0]:t}}}});var cn=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},un=document.documentElement,ln=Yt.assign(Ut,{hasListen:function(e,t,n){return ge(e,t,n)},on:function(e,t,n,i){return fe(e,t,n,i===!0)&&(En[t]?be(t,n):ye(e,t,n)),Ut},once:function(e,t,n){return Ut.on(e,t,n,!0)},off:function(e,t,n){return de(e,t,n)&&(En[t]?xe(t,n):me(e,t,n)),Ut},dispatchEvent:function(e,t,n){var i=void 0;return document.createEvent?(i=document.createEvent("Events"),i.initEvent(t,!0,!0,n),Yt.assign(i,n),e.dispatchEvent(i)):Ut.inDoc(e)&&(i=document.createEventObject(),Yt.assign(i,n),e.fireEvent("on"+t,i)),i}}),hn=/^(?:mouse|contextmenu|drag)|click/,pn=/^key/,fn=["altKey","bubbles","cancelable","ctrlKey","currentTarget","propertyName","eventPhase","metaKey","relatedTarget","shiftKey","target","view","which"],dn={},vn={props:["char","charCode","key","keyCode"],fix:function(e,t){null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode)}},gn={props:["button","buttons","clientX","clientY","offsetX","offsetY","pageX","pageY","screenX","screenY","toElement"],fix:function(e,t){var n,i,r,o=t.button;null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||document,i=n.documentElement,r=n.body,e.pageX=t.clientX+(i&&i.scrollLeft||r&&r.scrollLeft||0)-(i&&i.clientLeft||r&&r.clientLeft||0),e.pageY=t.clientY+(i&&i.scrollTop||r&&r.scrollTop||0)-(i&&i.clientTop||r&&r.clientTop||0)),e.which||void 0===o||(e.which=1&o?1:2&o?3:4&o?2:0)}},yn=function(){function e(t){cn(this,e);var n=t.type,i=dn[n],r=void 0,o=void 0;for(this.originalEvent=t,this.type=t.type,this.returnValue=!(t.defaultPrevented||t.returnValue===!1||t.getPreventDefault&&t.getPreventDefault()),this.timeStamp=t&&t.timeStamp||new Date+0,r=fn.length;r--;)o=fn[r],this[o]=t[o];if(i||(dn[n]=i=hn.test(n)?gn:pn.test(n)?vn:{}),i.props){var s=i.props;for(r=s.length;r--;)o=s[r],this[o]=t[o]}this.target||(this.target=t.srcElement||document),3==this.target.nodeType&&(this.target=this.target.parentNode),i.fix&&i.fix(this,t)}return e.prototype.preventDefault=function(){var e=this.originalEvent;this.returnValue=!1,e&&(e.returnValue=!1,e.preventDefault&&e.preventDefault())},e.prototype.stopPropagation=function(){var e=this.originalEvent;this.cancelBubble=!0,e&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())},e.prototype.stopImmediatePropagation=function(){var e=this.originalEvent;this.isImmediatePropagationStopped=!0,e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()},e}(),mn="__LISTEN__",bn=Ut.W3C?function(e,t,n,i){e.addEventListener(t,n,i)}:function(e,t,n){e.attachEvent("on"+t,n)},xn=Ut.W3C?function(e,t,n){e.removeEventListener(t,n)}:function(e,t,n){e.detachEvent("on"+t,n)},wn=["click","dblclick","keydown","keypress","keyup","mousedown","mousemove","mouseup","mouseover","mouseout","wheel","mousewheel","input","change","beforeinput","compositionstart","compositionupdate","compositionend","select","cut","copy","paste","beforecut","beforecopy","beforepaste","focusin","focusout","DOMFocusIn","DOMFocusOut","DOMActivate","dragend","datasetchanged"],En={},_n={focus:!0,blur:!0},Pn={},Cn={},Tn={};Yt.each(wn,function(e){En[e]=!0}),Ut.W3C||(delete En.change,delete En.select);var Sn=new Date;"onmouseenter"in un||Yt.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){Pn[e]={type:t,fix:function(e,t,n){var i=t.relatedTarget;return!i||i!==e&&!(16&e.compareDocumentPosition(i))}}}),Yt.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(e,t){window[e]&&!Pn.animationend&&(Pn.animationend={type:t})}),"oninput"in document.createElement("input")?navigator.userAgent.indexOf("MSIE 9")!==-1&&(Pn.input={type:"input",fix:function(e){e.oldValue=e.value}},document.addEventListener("selectionchange",function(e){var t=document.activeElement;if("TEXTAREA"===t.tagName||"INPUT"===t.tagName&&"text"===t.type){if(t.value==t.oldValue)return;t.oldValue=t.value,ge(t,"input")&&(e=new yn(e),e.type="input",Ee(t,"input",e))}})):(delete En.input,Pn.input={type:"propertychange",fix:function(e,t){return"value"==t.propertyName}},Pn.change={bind:function(e){if("checkbox"==e.type||"radio"==e.type)return e.$onchange||(e.$onchange=function(t){t.type="change",Ee(e,"change",t)},Ut.on(e,"click",e.$onchange)),!1},unbind:function(e){if("checkbox"==e.type||"radio"==e.type)return Ut.off(e,"click",e.$onchange),!1}}),void 0===document.onmousewheel&&!function(){var e=document.onwheel?"wheel":"DOMMouseScroll",t="wheel"===e?"deltaY":"detail";Pn.mousewheel={type:e,fix:function(e,n){return n.wheelDeltaY=n.wheelDelta=n[t]>0?-120:120,n.wheelDeltaX=0,!0}}}(),Yt.each(Pn,function(e,t){Cn[e.type||t]=t});var On=[],jn=void 0,kn=document.documentElement;"complete"===document.readyState?setTimeout(Pe):document.addEventListener?document.addEventListener("DOMContentLoaded",Pe):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&Pe()}),kn.doScroll&&null===window.frameElement&&window.external&&!function(){var e=function(){try{kn.doScroll("left"),Pe()}catch(t){setTimeout(e)}};e()}()),ln.on(window,"load",Pe),ln.ready=function(e){return jn?e():On.push(e),ln};var An=new Yt.Configuration,Nn=Yt.dynamicClass({statics:{commentCfg:"generateComments"},constructor:function(e){this._scope=Yt.obj(e.scope),this.el=e.el},scope:function(){var e=this._scope;return Yt.proxy(e)||e},realScope:function(){return this._scope},propScope:function(e){for(var t=this.realScope(),n=void 0;(n=t.$parent)&&!Yt.hasOwnProp(t,e);)t=n;return Yt.proxy(t)||t},exprScope:function(e){return this.propScope(Yt.parseExpr(e)[0])},observe:function(e,t){Yt.observe(this.exprScope(e),e,t)},unobserve:function(e,t){Yt.unobserve(this.exprScope(e),e,t)},get:function(e){return Yt.get(this.realScope(),e)},has:function(e){return Yt.has(this.realScope(),e)},set:function(e,t){Yt.set(this.scope(),e,t)},bind:function(){throw new Error("abstract method")},unbind:function(){throw new Error("abstract method")},destroy:function(){}});An.register(Nn.commentCfg,!0);var Fn=new Yt.Logger("tpl","debug"),Ln=Array.prototype.slice,Dn={},$n={register:function(e,t){if(Dn[e])throw Error("Filter["+e+"] is existing");"function"==typeof t&&(t={apply:t}),t.type=t.type||"normal",Dn[e]=t,Fn.debug("register Filter[%s:%s]",t.type,e)},get:function(e){return Dn[e]},apply:Ce,unapply:function(e,t,n){return Ce(e,t,n,!1)}},In={esc:27,tab:9,enter:13,space:32,"delete":[8,46],up:38,left:37,right:39,down:40},Rn={key:function(e){for(var t=e.which,n=void 0,i=1,r=arguments.length;i<r;i++)if(n=arguments[i],t==(In[n]||n))return!0;return!1},stop:function(e){e.stopPropagation()},prevent:function(e){e.preventDefault()},self:function(e){return e.target===e.currentTarget}};Yt.each(Rn,function(e,t){$n.register(t,{type:"event",apply:e})});var Hn={json:{apply:function(e,t){return"string"==typeof e?e:JSON.stringify(e,null,Number(t)||2)},unapply:function(e){try{return JSON.parse(e)}catch(t){return e}}},capitalize:function(e){return e||0===e?(e=e.toString(),e.charAt(0).toUpperCase()+e.slice(1)):""},uppercase:function(e){return e||0===e?e.toString().toUpperCase():""},lowercase:function(e){return e||0===e?e.toString().toLowerCase():""},currency:function(e,t){if(e=parseFloat(e),!isFinite(e)||!e&&0!==e)return"";t=null!=t?t:"$";var n=Math.abs(e).toFixed(2),i=n.slice(0,-3),r=i.length%3,o=r>0?i.slice(0,r)+(i.length>3?",":""):"",s=n.slice(-3),a=e<0?"-":"";return a+t+o+i.slice(r).replace(digitsRE,"$1,")+s},pluralize:function(e){var t=Ln.call(arguments,1);return t.length>1?t[e%10-1]||t[t.length-1]:t[0]+(1===e?"":"s")}};Yt.each(Hn,function(e,t){$n.register(t,e)});var Bn=Yt.reverseConvert("Math,Date,this,true,false,null,undefined,Infinity,NaN,isNaN,isFinite,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,parseInt,parseFloat,$scope".split(","),function(){return!0}),qn=/\s/g,Vn=/\n/g,Mn=/[\{,]\s*[\w\$_]+\s*:|('(?:[^'\\]|\\.)*'|"(?:[^"\\]|\\.)*"|`(?:[^`\\]|\\.)*\$\{|\}(?:[^`\\]|\\.)*`|`(?:[^`\\]|\\.)*`)|new |typeof |void |(\|\|)/g,Kn=/"(\d+)"/g,Xn=/^[A-Za-z_$][\w$]*(?:\.[A-Za-z_$][\w$]*|\['.*?'\]|\[".*?"\]|\[\d+\]|\[[A-Za-z_$][\w$]*\])*$/,zn=/^(?:true|false)$/,Gn=/[A-Za-z_$][\w$]*(?:\.[A-Za-z_$][\w$]*|\['.*?'\]|\[".*?"\]|\[\d+\]|\[[A-Za-z_$][\w$]*\])*[^\w$\.]/g,Yn=/^[A-Za-z_$][\w$]*/,Wn=[],Un=void 0,Zn=void 0,Jn=void 0,Qn={},ei=["$el"],ti=Yt.dynamicClass({extend:Nn,constructor:function(e){this["super"](arguments),this.expr=$e(e.expression,ei),An.get(Nn.commentCfg)&&(this.comment=document.createComment("Text Binding "+this.expr),Ut.before(this.comment,this.el)),this.observeHandler=this.observeHandler.bind(this)},value:function(){return this.expr.executeAll.call(this,this.scope(),this.el)},bind:function(){var e=this;Yt.each(this.expr.identities,function(t){e.observe(t,e.observeHandler)}),this.update(this.value())},unbind:function(){var e=this;Yt.each(this.expr.identities,function(t){e.unobserve(t,e.observeHandler)})},observeHandler:function(e,t){this.expr.simplePath?this.update(this.expr.applyFilter(t,this,[this.scope(),this.el])):this.update(this.value())},update:function(e){Yt.isNil(e)&&(e=""),e!==Ut.text(this.el)&&Ut.text(this.el,e)}}),ni={},ii=Yt.dynamicClass({extend:Nn,"abstract":!1,block:!1,priority:5,constructor:function(e){var t=this;this["super"](arguments),this.expr=e.expression,this.attr=e.attr,this.template=e.template,this.templateIndex=e.index,this.children=Yt.map(e.children,function(e){return t.template.parser.createDirective(e,{el:t.el,template:t.template,scope:t.realScope()})}),this.group=e.group,An.get(Nn.commentCfg)&&(this.comment=document.createComment("Directive["+this.attr+"]: "+this.expr),Ut.before(this.comment,this.el))},bindChildren:function(){Yt.each(this.children,function(e){e.bind()})},unbindChildren:function(){Yt.each(this.children,function(e){e.unbind()})},statics:{getPriority:function(e){return e.prototype.priority},isBlock:function(e){return e.prototype.block},isAbstract:function(e){return e.prototype["abstract"]},getDirective:function(e){return ni[e.toLowerCase()]},isDirective:function(e){return Yt.isExtendOf(e,ii)},register:function(e,t){var n=void 0;if(e=e.toLowerCase(),Yt.isObject(t))t.extend=t.extend||ii,n=Yt.dynamicClass(t);else{if(!Yt.isFunc(t)||!Yt.isExtendOf(t,ii))throw TypeError("Invalid Directive["+e+"] "+t);n=t}if(e in ni)throw new Error("Directive["+e+"] is existing");return ni[e]=n,Fn.debug("register Directive[%s]",e),n}}}),ri=Yt.dynamicClass({extend:Nn,constructor:function(e){var t=this;this["super"](arguments),this.template=e.template,this.directives=Yt.map(e.directives,function(e){return t.createDirective(e)}),this.bindedCount=0,this.bindedChildren=!1,this.parse=this.parse.bind(this),this.children=Yt.map(e.children,function(e){return t.createDirective(e)})},createDirective:function(e){return this.template.parser.createDirective(e,{el:this.el,template:this.template,scope:this.realScope(),group:this})},parse:function(){var e=this.bindedCount;if(e<this.directives.length){var t=this.directives[e],n=void 0;n=t.bind(),this.bindedCount++,n&&n instanceof Yt.YieId?n.then(this.parse):this.parse()}else Yt.each(this.children,function(e){e.bind()}),this.bindedChildren=!0},bind:function(){this.parse()},unbind:function(){var e=this.directives,t=this.bindedCount;for(this.bindedChildren&&(Yt.each(this.children,function(e){e.unbind()}),this.bindedChildren=!1);t--;)e[t].unbind();this.bindedCount=0}}),oi=Yt.dynamicClass({constructor:function(e){this.text=e},token:function(){throw new Error("abstract method")}});oi.NormalTextParser=Yt.dynamicClass({extend:oi,constructor:function(){this["super"](arguments),this.index=0,this.reg=/{([^{]+)}/g},token:function(){var e=void 0,t=this.reg;if(e=t.exec(this.text)){var n=t.lastIndex;return this.index=n,{token:e[1],start:n-e[0].length,end:n}}this.index=0}});var si=Yt.dynamicClass({statics:{TEXT:1,DIRECTIVE:2,DIRECTIVE_GROUP:3},constructor:function(e,t,n){this.el=e,this.directiveReg=t,this.TextParser=n,this.parse()},createDirective:function(e,t){switch(t=Yt.assign(t,e),e.type){case si.TEXT:return new ti(t);case si.DIRECTIVE:return new e.directive(t);case si.DIRECTIVE_GROUP:return new ri(t);default:throw new Error("invalid binding")}},clone:function(){var e=Ut.cloneNode(this.el);return{el:e,els:this.parseEls(e),bindings:this.bindings}},parseEls:function(e){var t=this,n=[];return Yt.isArrayLike(e)?Yt.each(e,function(e){t.parseElsNode(e,n)}):this.parseElsNode(e,n),n},parseElsNode:function(e,t){var n=this;t.push(e),1===e.nodeType&&this.els[t.length-1].parsed&&Yt.each(e.childNodes,function(e){n.parseElsNode(e,t)})},parse:function(){var e=this;this.els=[],this.bindings=[],Yt.isArrayLike(this.el)?Yt.each(this.el,function(t){e.parseNode(t,e.bindings)}):this.parseNode(this.el,this.bindings)},parseNode:function(e,t){switch(e.nodeType){case 1:this.parseElement(e,t);break;case 3:this.parseText(e,t)}},parseText:function(e,t){for(var n=Ut.text(e),i=new this.TextParser(n),r=void 0,o=0,s=this.els;r=i.token();)this.insertText2(n.substring(o,r.start),e),this.insertText("binding",e),t.push({expression:r.token,index:s.length-1,type:si.TEXT}),o=r.end;o?(this.insertText2(n.substr(o),e),Ut.remove(e)):this.pushEl(e,!1)},parseElement:function(e,t){var n=this,i=[],r=this.els.length,o=this.directiveReg,s=void 0,a=void 0;Yt.each(e.attributes,function(e){var t=e.name;if(o.test(t)){var n=ii.getDirective(t.replace(o,""));if(n){var s={expression:e.value,index:r,directive:n,attr:t,type:si.DIRECTIVE};if(ii.isAbstract(n))return i=[s],a=ii.isBlock(n),!1;ii.isBlock(n)&&(a=!0),i.push(s)}else Fn.warn("Directive["+t+"] is undefined")}}),1==i.length?s=i[0]:i.length&&(s={directives:i.sort(function(e,t){return ii.getPriority(t.directive)-ii.getPriority(e.directive)}),index:r,type:si.DIRECTIVE_GROUP}),s&&(t.push(s),t=s.children=[]),this.pushEl(e,!a),a||Yt.each(Yt.map(e.childNodes,function(e){return e}),function(e){n.parseNode(e,t)})},pushEl:function(e,t){e.parsed=t,this.els.push(e)},insertText:function(e,t){var n=document.createTextNode(e);return Ut.before(n,t),this.pushEl(n,!1),n},insertText2:function(e,t){if(e=Yt.trim(e))return this.insertText(e,t)}}),ai=Yt.dynamicClass({constructor:function(e,t){this.el=e,this.bindings=t},before:function(e){return this.bind(),Ut.before(this.el,Ut.query(e)),this},after:function(e){return this.bind(),Ut.after(this.el,Ut.query(e)),this},prependTo:function(e){return this.bind(),Ut.prepend(Ut.query(e),this.el),this},appendTo:function(e){return this.bind(),Ut.append(Ut.query(e),this.el),this},bind:function(){return this.binded||(Yt.each(this.bindings,function(e){e.bind()}),this.binded=!0),this},unbind:function(){return this.binded&&(Yt.each(this.bindings,function(e){e.unbind()}),this.binded=!1),this},destroy:function(){this.binded&&Yt.each(this.bindings,function(e){e.unbind(),e.destroy()}),Ut.remove(this.el),this.bindings=void 0,this.el=void 0}}),ci="directiveReg",ui="textParser";An.register(ci,/^tpl-/),An.register(ui,oi.NormalTextParser);var li=0,hi={},pi=Yt.dynamicClass({statics:{get:function(e){return hi[e]}},constructor:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];this.id=t.id||li++,this.directiveReg=Re(t,ci),this.TextParser=Re(t,ui),this.el=Ie(e,t.clone!==!1),this.parser=new si(this.el,this.directiveReg,this.TextParser),hi[this.id]=this},complie:function(e){var t=this,n=this.parser.clone(),i=n.els,r=void 0;return Ut.append(document.createDocumentFragment(),n.el),r=Yt.map(n.bindings,function(n){return t.parser.createDirective(n,{el:i[n.index],scope:e,template:t})}),new ai(n.el,r)}}),fi="directiveReg",di="textParser";An.register(fi,/^tpl-/),An.register(di,oi.NormalTextParser);var vi=0,gi={},yi=Yt.dynamicClass({statics:{get:function(e){return gi[e]}},constructor:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];this.id=t.id||vi++,this.directiveReg=Be(t,fi),this.TextParser=Be(t,di),this.el=He(e,t.clone!==!1),this.parser=new si(this.el,this.directiveReg,this.TextParser),gi[this.id]=this},complie:function(e){var t=this,n=this.parser.clone(),i=n.els,r=void 0;return Ut.append(document.createDocumentFragment(),n.el),r=Yt.map(n.bindings,function(n){return t.parser.createDirective(n,{el:i[n.index],scope:e,template:t})}),new ai(n.el,r)}}),mi=/^\s*([\s\S]+)\s+in\s+([\S]+)(\s+track\s+by\s+([\S]+))?\s*$/,bi=/^(\(\s*([^,\s]+)(\s*,\s*([\S]+))?\s*\))|([^,\s]+)(\s*,\s*([\S]+))?$/,xi=ii.register("each",Yt.dynamicClass({extend:ii,"abstract":!0,block:!0,priority:10,constructor:function(){this["super"](arguments),this.observeHandler=this.observeHandler.bind(this);var e=this.expr.match(mi);if(!e)throw Error("Invalid Expression["+this.expr+"] on Each Directive");this.scopeExpr=e[2],this.indexExpr=e[4];var t=e[1].match(bi);if(!t)throw Error("Invalid Expression["+e[1]+"] on Each Directive");this.valueAlias=t[2]||t[5],this.keyAlias=t[4]||t[7],Ut.removeAttr(this.el,this.attr),this.begin=document.createComment("each begin"),this.end=document.createComment("each end"),Ut.replace(this.el,this.begin),Ut.after(this.end,this.begin);var n=this.template.id+"-"+this.templateIndex;(this.eachTemplate=yi.get(n))||(this.eachTemplate=new yi(this.el,{id:n,directiveReg:this.template.directiveReg,TextParser:this.template.TextParser,clone:!1})),this.el=null},update:function(e){var t=this,n=this.realScope(),i=this.begin,r=this.end,o=this.indexExpr,s=this.valueAlias,a=(this.keyAlias,!this.cache),c=this.sort,u=this.sort=new Array(e.length),l=a?this.cache={}:this.cache,h=[],p=[];Yt.each(e,function(i,c){var h=o?Yt.get(i,o):c,f=!a&&l[h];f?t.initScope(f,i,c,h):(f=l[h]=t.createScope(n,i,c,h),a||p.push(f)),u[c]=f,a&&(f.$tpl=t.eachTemplate.complie(f),e[c]=f[s],f.$tpl.before(r))}),a||(Yt.each(c,function(e){var t=l[e.$index];t&&t!==u[e.$sort]&&(h.push(e),l[e.$index]=void 0)}),Yt.each(p,function(n){var r=h.pop();r?(t.initScope(r,n),l[n.$index]=r,u[n.$sort]=r,n=r):n.$tpl=t.eachTemplate.complie(n),e[n.$sort]=n[s],n.$tpl.after(n.$sort?u[n.$sort-1].$tpl.els:i)}),Yt.each(h,function(e){e.$tpl.destroy()}))},createScope:function(e,t,n,i){var r=Yt.create(e);return r.$parent=e,r.$eachContext=this,r.$tpl=null,this.initScope(r,t,n,i,!0),r},initScope:function(e,t,n,i,r){r||(e=e.$tpl.scope),e.$sort=n,e[this.valueAlias]=t,this.keyAlias&&(e[this.keyAlias]=n),e.$index=i},bind:function(){this.observe(this.scopeExpr,this.observeHandler),this.update(this.target())},unbind:function(){this.unobserve(this.scopeExpr,this.observeHandler)},target:function(){return this.get(this.scopeExpr)},observeHandler:function(e,t){this.update(t)}})),wi=["$el","$event"],Ei=Yt.dynamicClass({extend:ii,constructor:function(){this["super"](arguments),this.handler=this.handler.bind(this),this.expression=$e(this.expr,wi)},handler:function(e){e.stopPropagation();var t=this.scope(),n=this.expression;if(this.expression.applyFilter(e,this,[t,this.el,e])!==!1){var i=n.execute.call(this,t,this.el,e);if(n.simplePath)if(Yt.isFunc(i)){var r=this.propScope(n.path[0]);i.call(r,t,this.el,e,r)}else Fn.warn("Invalid Event Handler:%s",this.expr,i)}},bind:function(){Ut.on(this.el,this.eventType,this.handler),this.bindChildren()},unbind:function(){Ut.off(this.el,this.eventType,this.handler),this.unbindChildren()}}),_i=["blur","change","click","dblclick","error","focus","keydown","keypress","keyup","load","mousedown","mousemove","mouseout","mouseover","mouseup","resize","scroll","select","submit","unload",{name:"oninput",eventType:"input propertychange"}],Pi=Yt.assign(Yt.convert(_i,function(e){var t=Yt.isObject(e)?e.name:e;return Yt.hump(t+"Directive")},function(e){Yt.isObject(e)||(e={eventType:e});var t=e.name||"on"+e.eventType;return e.extend=Ei,ii.register(t,e)}),{EventDirective:Ei}),Ci=["$el"],Ti=Yt.dynamicClass({extend:ii,constructor:function(){this["super"](arguments),this.observeHandler=this.observeHandler.bind(this),this.expression=$e(this.expr,Ci)},realValue:function(){return this.expression.execute.call(this,this.scope(),this.el)},value:function(){return this.expression.executeAll.call(this,this.scope(),this.el)},listen:function(){var e=this;Yt.each(this.expression.identities,function(t){e.observe(t,e.observeHandler)}),this.update(this.value())},bind:function(){this.listen()},unlisten:function(){var e=this;Yt.each(this.expression.identities,function(t){e.unobserve(t,e.observeHandler)})},unbind:function(){this.unlisten()},blankValue:function(e){return 0==arguments.length&&(e=this.value()),Yt.isNil(e)?"":e},observeHandler:function(e,t){this.expression.simplePath?this.update(this.expression.applyFilter(t,this,[this.scope(),this.el])):this.update(this.value())},update:function(e){throw"abstract method"}}),Si="change",Oi="input",ji="SELECT",ki="INPUT",Ai="TEXTAREA",Ni="radio",Fi="checkbox",Li={text:{block:!0,update:function(e){Ut.text(this.el,this.blankValue(e))}},html:{block:!0,update:function(e){Ut.html(this.el,this.blankValue(e))}},"class":{update:function(e){e&&"string"==typeof e?this.handleArray(Yt.trim(e).split(/\s+/)):e instanceof Array?this.handleArray(e):e&&"object"==typeof e?this.handleObject(e):this.cleanup()},handleObject:function(e){this.cleanup(e,!1);var t=this.prevKeys=[],n=this.el;for(var i in e)e[i]?(Ut.addClass(n,i),t.push(i)):Ut.removeClass(n,i)},handleArray:function(e){this.cleanup(e,!0);var t=this.prevKeys=[],n=this.el;Yt.each(e,function(e){e&&(t.push(e),Ut.addClass(n,e))})},cleanup:function(e,t){var n=this.prevKeys;if(n)for(var i=n.length,r=this.el;i--;){var o=n[i];e&&(t?Yt.indexOf(e,o)!=-1:Yt.hasOwnProp(e,o))||Ut.removeClass(r,o)}}},style:{update:function(e){e&&Yt.isString(e)?Ut.style(this.el,e):e&&Yt.isObject(e)&&this.handleObject(e)},handleObject:function(e){this.cleanup(e);var t=(this.prevKeys=[],this.el);Yt.each(e,function(e,n){Ut.css(t,n,e)})}},show:{update:function(e){Ut.css(this.el,"display",e?"":"none")}},hide:{update:function(e){Ut.css(this.el,"display",e?"none":"")}},value:{update:function(e){Ut.val(this.el,this.blankValue(e))}},"if":{priority:9,bind:function(){return this.yieId=new Yt.YieId,this.listen(),this.yieId},unbind:function(){this.unlisten(),this.unbindChildren()},update:function(e){e?(this.bindChildren(),this.yieId&&(this.yieId.done(),this.yieId=void 0),Ut.css(this.el,"display","")):Ut.css(this.el,"display","none")}},checked:{update:function(e){Yt.isArray(e)?Ut.checked(this.el,Yt.indexOf(e,Ut.val(this.el))):Ut.checked(this.el,!!e)}},selected:{update:function(e){}},focus:{update:function(e){e&&Ut.focus(this.el)}},input:{priority:4,constructor:function(){if(this["super"](arguments),!this.expression.simplePath)throw TypeError("Invalid Expression["+this.expression.expr+"] on InputDirective");this.onChange=this.onChange.bind(this);var e=this.tag=this.el.tagName;switch(e){case ji:this.event=Si;break;case ki:var t=this.type=this.el.type;this.event=t==Ni||t==Fi?Si:Oi;break;case Ai:throw TypeError("Directive[input] not support "+e);default:throw TypeError("Directive[input] not support "+e)}},bind:function(){this["super"](),Ut.on(this.el,this.event,this.onChange)},unbind:function(){this["super"](),Ut.off(this.el,this.event,this.onChange)},setRealValue:function(e){this.set(this.expression.path,e)},setValue:function(e){this.setRealValue(this.expression.applyFilter(e,this,[this.scope(),this.el],!1))},onChange:function(e){var t=this.elVal(),n=this.val;t!=n&&this.setValue(t),e.stopPropagation()},update:function(e){var t=this.blankValue(e);t!=this.val&&this.elVal(this.val=t)},elVal:function(e){var t=this.tag;switch(t){case ji:break;case ki:var n=this.type;if(n==Ni||n==Fi){if(0==arguments.length)return Ut.checked(this.el)?Ut.val(this.el):void 0;var i=void 0;i=e==Ut.val(this.el),Ut.checked(this.el)!=i&&Ut.checked(this.el,i)}else{if(0==arguments.length)return Ut.val(this.el);e!=Ut.val(this.el)&&Ut.val(this.el,e)}break;case Ai:throw TypeError("Directive[input] not support "+t);default:throw TypeError("Directive[input] not support "+t)}}}},Di=Yt.assign(Yt.convert(Li,function(e,t){return console.log("name",t),Yt.hump(t+"Directive")},function(e,t){return console.log("name2",t),e.extend=Ti,ii.register(t,e)}),{SimpleDirective:Ti}),$i=Yt.assign({EachDirective:xi},Pi,Di),Ii=Yt.assign(pi,Yt,Ut,{filter:$n,expression:$e,Directive:ii,directives:$i,TextParser:oi,config:An,TemplateParser:si,init:function(e){zt.init(e),An.config(e)}});return Ii});
//# sourceMappingURL=tpl.all.min.js.map