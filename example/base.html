<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>tpl.js â€¢ Basic </title>
</head>

<body>
    <a href="../index.html">Back</a>
</body>
<script src="../node_modules/jquery/jquery.js"></script>
<script src="../node_modules/observer.js/dist/observer.js"></script>
<script src="../dist/tpl.js"></script>
<script type="text/javascript">

tpl.ready(function() {
    tpl.init({
        lazy: false
    })
    var data = {
        input: null,
        radio1: 'Radio1 Selected',
        radio2: 'Radio2 Selected',
        check1: 'CheckBox1 Selected',
        check2: 'CheckBox2 Selected',
        handler: function() {
            console.log('event:', this, arguments);
        },
        eachArray: []
    }
    tpl.proxy.on(data, function(obj, proxy){
      data = proxy || obj;
    });
    var docTpl = new tpl($(document.getElementById('tpl/code.html')).html());

    function renderTempl(id, renderTo) {
        var html = $(document.getElementById(id)).html();
        new tpl(html).complie(data)
            .appendTo(renderTo || document.body);
        docTpl.complie({
            template: html,
            templateUrl: id,
            js: '$(document.body).append(new tpl(' + id + ').complie({\n\t\n}).el);',
            toggleSource: function() {
                this.openSource = !this.openSource;
                console.log(arguments)
            }
        }).appendTo(renderTo || document.body);
    }
    var count = 10;
    for (var i = 0; i < count; i++) {
        data.eachArray.push({
            title: 'test-' + i
        });
    }

    renderTempl('tpl/input.html');
    renderTempl('tpl/checkbox.html');
    var s = new Date();
    renderTempl('tpl/each.html');
    console.log('reander each use:' + (new Date() - s));
    setTimeout(function() {
        s = new Date();
        for (var i = 0; i < count; i++) {
            data.eachArray[i].title = 'test---' + i;
        }
        setTimeout(function() {
            console.log('update each use:' + (new Date() - s));
        }, 0);
    }, 100000)
});
</script>
<script id="tpl/code.html" type="text/template">
    <div style="margin:0 10px">
        <a href="javascript:void 0;" type="button" tpl-onclick="toggleSource">Source</a>
        <div tpl-if="openSource">
            {templateUrl}:{templateUrl}:
            <br/>
            <pre tpl-text="template"></pre> javascript:
            <br/>
            <pre tpl-text="js"></pre>
        </div>
    </div>
</script>
<script id="tpl/input.html" type="text/template">
    <div style="padding:10px">
        <label>One Way: </label>
        <input tpl-value="input" />
    </div>
    <div style="padding:10px">
        <label>Two Way: </label>
        <input tpl-input="input" tpl-onclick='handler' />
        <p tpl-if="input">
            Input: <strong>{input}</strong>
        </p>
    </div>
</script>
<script id="tpl/checkbox.html" type="text/template">
    <div style="padding:10px">
        <label for="radio1">Test Radio1</label>
        <input type="Radio" id="radio1" name="radio" tpl-value="radio1" tpl-input="input" />
        <label for="radio2">Test Radio2</label>
        <input type="Radio" id="radio2" name="radio" tpl-value="radio2" tpl-input="input" />
    </div>
    <div style="padding:10px">
        <label for="check1" tpl-onclick='handler'>Test CheckBox1</label>
        <input type="CheckBox" id="check1" name="check" tpl-value="check1" tpl-input="input" />
        <label for="check2">Test CheckBox2</label>
        <input type="CheckBox" id="check2" name="check" tpl-value="check2" tpl-input="input" />
    </div>
</script>
<script id="tpl/each.html" type="text/template">
    <div style="padding:10px">
        <div tpl-each="item, idx in eachArray" tpl-class="input">
            <span tpl-text="idx"></span>:::<span tpl-text="item.title"></span>
        </div>
    </div>
</script>

</html>
